"use strict";!function(){angular.module("Meals",["ui.router"])}(),function(){function e(e,n){e.state("app",{url:"/app",template:"<app-page></app-page>"}).state("app.main",{url:"/main",template:"<main-page></main-page>"}).state("app.main.meals",{url:"/meals",template:"<meals-list id='mealsList'></meals-list>"}).state("app.main.drinks",{url:"/drinks",template:"<drinks-list></drinks-list>"}).state("app.meal",{url:"/meal/:path",controllerAs:"meal",controller:t,template:"<meal-page id='meal' path='{{ meal.path }}'></meal-page>"}).state("app.cart",{url:"/cart",template:"<cart-page id='cart'></cart-page>"}).state("error",{url:"/error",template:"<error-page></error-page>"}),n.otherwise("/app/main/meals")}function t(e){this.path=e.path}e.$inject=["$stateProvider","$urlRouterProvider"],t.$inject=["$stateParams"],angular.module("Meals").config(e)}(),function(){function e(){function e(e){var t=0,n=!0,r=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var i=a.value;t+=i.price}}catch(e){r=!0,o=e}finally{try{!n&&l.return&&l.return()}finally{if(r)throw o}}return t}function t(){return p}function n(e){p=e}function r(){return s.length}function o(e){m=e}function a(e,t){var n={};n.id=e.id,n.name=e.name,n.price=e.price,n.amount=t,m&&(n.modifiers=m.slice()),m=null,s.push(n)}function l(){return s}function i(){var t=0;if(s.length>0)for(var n=0,r=s.length;n<r;n++)t+=s[n].price*s[n].amount,s[n].modifiers&&(t+=e(s[n].modifiers)*s[n].amount);return t.toFixed(2)}function c(){m=null}function u(){s.splice(p,1)}var s=[],m=null,p=0,f={getIndexEditMeal:t,setIndexEditMeal:n,getCartListCount:r,addModifiersToList:o,addMealToCartList:a,getCartList:l,getTotalPrice:i,deleteModifiers:c,removeMeal:u};return f}angular.module("Meals").factory("CartFactory",e)}(),function(){function e(e,t){function n(e,t,n){i(e),u(t),p(n)}function r(t){return e({method:"GET",url:d}).success(function(e){g=e,M=e.currency,t.resolve(e)}).error(function(e,n){t.reject("Error in $http request"),console.log(e),console.log(n)}),t}function o(){return null!==h&&h.modifiers}function a(){var e=t.defer();return g?e.resolve(g):e=r(e),e.promise}function l(){return h}function i(e){h=e}function c(){return C}function u(e){C=e}function s(){return M}function m(){return y}function p(e){y=e}function f(e){h=g.products.filter(function(t){return t.id===e})[0],h||(h=g.drinks.filter(function(t){return t.id===e})[0])}var d="meals.json",g=null,M="",h=null,C="new",y=1,v={getModifiers:o,getMeals:a,getCurrentMeal:l,setCurrentMeal:i,getCurrentMealStatus:c,setCurrentMealStatus:u,getCurrency:s,getCurrentMealAmount:m,setCurrentMealAmount:p,setCurrentMealById:f,openMeal:n};return v}e.$inject=["$http","$q"],angular.module("Meals").factory("MealsFactory",e)}(),function(){function e(e){function t(){var t=e.getCartList()[e.getIndexEditMeal()];return t.modifiers}function n(e,t){return e.some(function(e){return t.name===e.name})}function r(e,t){return e.filter(function(e){return t.name!==e.name})}function o(t,o){n(t,o)?t=r(t,o):t.push(o),e.addModifiersToList(t)}function a(e,t,n){if(n)for(var r=0,a=n.length;r<a;r++)for(var l=0,i=e.length;l<i;l++)e[l].name===n[r].name&&(e[l].check=!0,o(t,e[l]))}var l={getCheckedModifiers:t,modifierHasBeenSelected:n,deleteModifier:r,selectModifier:o,pickCheckedModifiers:a};return l}e.$inject=["CartFactory"],angular.module("Meals").factory("ModifiersFactory",e)}(),function(){function e(){}angular.module("Meals").component("appPage",{templateUrl:"component-templates/app/template/appPage.html",bindings:{},controllerAs:"app",controller:e})}(),function(){function e(e,t){function n(n,r){t.setIndexEditMeal(r),e.setCurrentMealById(n.id),e.setCurrentMealAmount(n.amount),e.setCurrentMealStatus("edit")}var r=this;r.currency=e.getCurrency(),r.cartList=t.getCartList(),r.totalPrice=t.getTotalPrice(),r.editMeal=n}e.$inject=["MealsFactory","CartFactory"],angular.module("Meals").component("cartPage",{templateUrl:"component-templates/cart/template/cartPage.html",bindings:{},controllerAs:"cart",controller:e})}(),function(){function e(){}angular.module("Meals").component("cartIconPage",{templateUrl:"component-templates/cartIcon/template/cartIconPage.html",bindings:{count:"@"},controllerAs:"cartIcon",controller:e})}(),function(){function e(e){function t(){e.getMeals().then(n)}function n(e){a.currency=e.currency,l=e.drinks}function r(t){e.openMeal(t,"new",1)}function o(){return a.onlySoftDrinks?l.filter(function(e){return e.tipple!==!0}):l}var a=this,l=[];a.onlySoftDrinks=!1,a.currency="",a.openDrink=r,a.getDrinksForView=o,t()}e.$inject=["MealsFactory"],angular.module("Meals").component("drinksList",{templateUrl:"component-templates/drinksList/template/drinksList.html",bindings:{},controllerAs:"drinksList",controller:e})}(),function(){function e(){}angular.module("Meals").component("errorPage",{templateUrl:"component-templates/error/template/errorPage.html",bindings:{},controllerAs:"error",controller:e})}(),function(){function e(){}angular.module("Meals").component("footerPage",{templateUrl:"component-templates/footer/template/footerPage.html",bindings:{},controllerAs:"footer",controller:e})}(),function(){function e(){}angular.module("Meals").component("headerPage",{templateUrl:"component-templates/header/template/headerPage.html",bindings:{},controllerAs:"header",controller:e})}(),function(){function e(){}angular.module("Meals").component("logoPage",{templateUrl:"component-templates/logo/template/logoPage.html",bindings:{},controllerAs:"logo",controller:e})}(),function(){function e(){}angular.module("Meals").component("mainPage",{templateUrl:"component-templates/main/template/mainPage.html",bindings:{},controllerAs:"main",controller:e})}(),function(){function e(e,t){function n(){t.addMealToCartList(a.currentMeal,a.selectAmount)}function r(){t.removeMeal(),t.deleteModifiers()}function o(){t.removeMeal(),a.addMeal()}var a=this;a.currentMeal=e.getCurrentMeal(),a.currency=e.getCurrency(),a.selectAmount=e.getCurrentMealAmount(),a.mealStatus=e.getCurrentMealStatus(),a.cartCount=t.getCartListCount(),a.addMeal=n,a.removeMeal=r,a.saveMeal=o}e.$inject=["MealsFactory","CartFactory"],angular.module("Meals").component("mealPage",{templateUrl:"component-templates/meal/template/mealPage.html",bindings:{path:"@"},controllerAs:"meal",controller:e})}(),function(){function e(e){function t(){e.getMeals().then(n)}function n(e){o.currency=e.currency,o.products=e.products}function r(t){e.openMeal(t,"new",1)}var o=this;o.openMeal=r,o.currency="",o.products=null,t()}e.$inject=["MealsFactory"],angular.module("Meals").component("mealsList",{templateUrl:"component-templates/mealsList/template/mealsList.html",bindings:{},controllerAs:"mealsList",controller:e})}(),function(){function e(){}angular.module("Meals").component("menuPage",{templateUrl:"component-templates/menu/template/menuPage.html",bindings:{},controllerAs:"menu",controller:e})}(),function(){function e(e,t){function n(){o.modifiers&&o.modifiers.forEach(function(e){return e.check=!1})}function r(e){t.selectModifier(a,e)}var o=this,a=[];if(o.modifiers=e.getModifiers(),o.selectModifier=r,n(),"edit"===e.getCurrentMealStatus()){var l=t.getCheckedModifiers();t.pickCheckedModifiers(o.modifiers,a,l)}}e.$inject=["MealsFactory","ModifiersFactory"],angular.module("Meals").component("modifiersPage",{templateUrl:"component-templates/modifiers/template/modifiersPage.html",bindings:{currency:"@"},controllerAs:"mod",controller:e})}(),function(){function e(){function e(e){n.select=e}function t(e){return n.select===e}var n=this;n.selectNum=e,n.activeNum=t}angular.module("Meals").component("selectCount",{templateUrl:"component-templates/selectCount/template/selectCountPage.html",bindings:{select:"="},controllerAs:"select",controller:e})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsIm1haW4uanMiLCJjb25maWcuanMiLCJjYXJ0RmFjdG9yeS5qcyIsIm1lYWxzRmFjdG9yeS5qcyIsIm1vZGlmaWVyc0ZhY3RvcnkuanMiLCJhcHAvYXBwLmpzIiwiY2FydC9jYXJ0LmpzIiwiY2FydEljb24vY2FydEljb24uanMiLCJkcmlua3NMaXN0L2RyaW5rc0xpc3QuanMiLCJlcnJvci9lcnJvci5qcyIsImZvb3Rlci9mb290ZXIuanMiLCJoZWFkZXIvaGVhZGVyLmpzIiwibG9nby9sb2dvLmpzIiwibWFpbi9tYWluLmpzIiwibWVhbC9tZWFsLmpzIiwibWVhbHNMaXN0L21lYWxzTGlzdC5qcyIsIm1lbnUvbWVudS5qcyIsIm1vZGlmaWVycy9tb2RpZmllcnMuanMiLCJzZWxlY3RDb3VudC9zZWxlY3RDb3VudC5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJzdGF0ZSIsInVybCIsInRlbXBsYXRlIiwiY29udHJvbGxlckFzIiwiY29udHJvbGxlciIsIk1lYWxDb250cm9sbGVyIiwib3RoZXJ3aXNlIiwiJHN0YXRlUGFyYW1zIiwidGhpcyIsInBhdGgiLCJDYXJ0RmFjdG9yeSIsImdldE1vZGlmaWVyc1ByaWNlIiwibW9kaWZpZXJzQXJyIiwidG90YWxQcmljZSIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24iLCJfZGlkSXRlcmF0b3JFcnJvciIsIl9pdGVyYXRvckVycm9yIiwidW5kZWZpbmVkIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm5leHQiLCJkb25lIiwibW9kaWZpZXIiLCJ2YWx1ZSIsInByaWNlIiwiZXJyIiwicmV0dXJuIiwiZ2V0SW5kZXhFZGl0TWVhbCIsImluZGV4RWRpdE1lYWwiLCJzZXRJbmRleEVkaXRNZWFsIiwiaW5kZXgiLCJnZXRDYXJ0TGlzdENvdW50IiwiY2FydExpc3QiLCJsZW5ndGgiLCJhZGRNb2RpZmllcnNUb0xpc3QiLCJtb2RpZiIsIm1vZGlmaWVycyIsImFkZE1lYWxUb0NhcnRMaXN0IiwibWVhbCIsImFtb3VudCIsIm5ld01lYWwiLCJpZCIsIm5hbWUiLCJzbGljZSIsInB1c2giLCJnZXRDYXJ0TGlzdCIsImdldFRvdGFsUHJpY2UiLCJpIiwibGVuIiwidG9GaXhlZCIsImRlbGV0ZU1vZGlmaWVycyIsInJlbW92ZU1lYWwiLCJzcGxpY2UiLCJmYWN0b3J5IiwiTWVhbHNGYWN0b3J5IiwiJGh0dHAiLCIkcSIsIm9wZW5NZWFsIiwic3RhdHVzIiwic2V0Q3VycmVudE1lYWwiLCJzZXRDdXJyZW50TWVhbFN0YXR1cyIsInNldEN1cnJlbnRNZWFsQW1vdW50IiwiZ2V0TWVhbHNGcm9tSHR0cCIsImRlZmVycmVkIiwibWV0aG9kIiwibWVhbEFwaVVybCIsInN1Y2Nlc3MiLCJkYXRhIiwibWVhbHMiLCJjdXJyZW5jeSIsInJlc29sdmUiLCJlcnJvciIsInJlamVjdCIsImNvbnNvbGUiLCJsb2ciLCJnZXRNb2RpZmllcnMiLCJjdXJyZW50TWVhbCIsImdldE1lYWxzIiwiZGVmZXIiLCJwcm9taXNlIiwiZ2V0Q3VycmVudE1lYWwiLCJnZXRDdXJyZW50TWVhbFN0YXR1cyIsImN1cnJlbnRNZWFsU3RhdHVzIiwiZ2V0Q3VycmVuY3kiLCJnZXRDdXJyZW50TWVhbEFtb3VudCIsImN1cnJlbnRBbW91bnQiLCJzZXRDdXJyZW50TWVhbEJ5SWQiLCJwcm9kdWN0cyIsImZpbHRlciIsIml0ZW0iLCJkcmlua3MiLCJNb2RpZmllcnNGYWN0b3J5IiwiZ2V0Q2hlY2tlZE1vZGlmaWVycyIsIm1vZGlmaWVySGFzQmVlblNlbGVjdGVkIiwic2VsZWN0ZWRNb2RpZmllcnMiLCJzb21lIiwiZGVsZXRlTW9kaWZpZXIiLCJzZWxlY3RNb2RpZmllciIsInBpY2tDaGVja2VkTW9kaWZpZXJzIiwiY2hlY2tlZE1vZGlmaWVycyIsImxlbkNoZWNrZWRNb2RpZmllcnMiLCJqIiwibGVuTW9kaWZpZXJzIiwiY2hlY2siLCJBcHBDb250cm9sbGVyIiwiY29tcG9uZW50IiwidGVtcGxhdGVVcmwiLCJiaW5kaW5ncyIsIkNhcnRDb250cm9sbGVyIiwiZWRpdE1lYWwiLCJ2bSIsIkNhcnRJY29uQ29udHJvbGxlciIsImNvdW50IiwiRHJpbmtzTGlzdENvbnRyb2xsZXIiLCJhY3RpdmF0ZSIsInRoZW4iLCJnZXREcmlua3MiLCJkcmlua3NPYmoiLCJvcGVuRHJpbmsiLCJkcmluayIsImdldERyaW5rc0ZvclZpZXciLCJvbmx5U29mdERyaW5rcyIsInRpcHBsZSIsIkVycm9yQ29udHJvbGxlciIsIkZvb3RlckNvbnRyb2xsZXIiLCJIZWFkZXJDb250cm9sbGVyIiwiTG9nb0NvbnRyb2xsZXIiLCJNYWluQ29udHJvbGxlciIsImFkZE1lYWwiLCJzZWxlY3RBbW91bnQiLCJzYXZlTWVhbCIsIm1lYWxTdGF0dXMiLCJjYXJ0Q291bnQiLCJNZWFsc0xpc3RDb250cm9sbGVyIiwiZ2V0UHJvZHVjdHMiLCJtZWFsc09iaiIsIk1lbnVDb250cm9sbGVyIiwiTW9kaWZpZXJzQ29udHJvbGxlciIsImNsZWFuUGlja01vZGlmaWVycyIsImZvckVhY2giLCJTZWxlY3RDb3VudENvbnRyb2xsZXIiLCJzZWxlY3ROdW0iLCJudW0iLCJzZWxlY3QiLCJhY3RpdmVOdW0iXSwibWFwcGluZ3MiOiJBQUFBLGNDQUEsV0FHSUEsUUFDS0MsT0FBTyxTQUFVLGlCQ0oxQixXQU9JLFFBQVNDLEdBQU9DLEVBQWdCQyxHQUU1QkQsRUFDS0UsTUFBTSxPQUNIQyxJQUFLLE9BQ0xDLFNBQVUsMEJBRWJGLE1BQU0sWUFDSEMsSUFBSyxRQUNMQyxTQUFVLDRCQUViRixNQUFNLGtCQUNIQyxJQUFLLFNBQ0xDLFNBQVUsNkNBRWJGLE1BQU0sbUJBQ0hDLElBQUssVUFDTEMsU0FBVSxnQ0FFYkYsTUFBTSxZQUNIQyxJQUFLLGNBQ0xFLGFBQWMsT0FDZEMsV0FBWUMsRUFDWkgsU0FBVSw2REFFYkYsTUFBTSxZQUNIQyxJQUFLLFFBQ0xDLFNBQVUsc0NB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LGVBQ1BDLFlBQWMsZ0VBQ2RDLFVBQ0lvQyxPQUFRLEtBRVo5SSxhQUFlLFNBQ2ZDLFdBQWEwSSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiTWVhbHNcIiwgW1widWkucm91dGVyXCJdKTtcbn0pKCk7XG5cInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiTWVhbHNcIikuY29uZmlnKGNvbmZpZyk7XG5cbiAgICBmdW5jdGlvbiBjb25maWcoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKFwiYXBwXCIsIHtcbiAgICAgICAgICAgIHVybDogXCIvYXBwXCIsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogXCI8YXBwLXBhZ2U+PC9hcHAtcGFnZT5cIlxuICAgICAgICB9KS5zdGF0ZShcImFwcC5tYWluXCIsIHtcbiAgICAgICAgICAgIHVybDogXCIvbWFpblwiLFxuICAgICAgICAgICAgdGVtcGxhdGU6IFwiPG1haW4tcGFnZT48L21haW4tcGFnZT5cIlxuICAgICAgICB9KS5zdGF0ZShcImFwcC5tYWluLm1lYWxzXCIsIHtcbiAgICAgICAgICAgIHVybDogXCIvbWVhbHNcIixcbiAgICAgICAgICAgIHRlbXBsYXRlOiBcIjxtZWFscy1saXN0IGlkPSdtZWFsc0xpc3QnPjwvbWVhbHMtbGlzdD5cIlxuICAgICAgICB9KS5zdGF0ZShcImFwcC5tYWluLmRyaW5rc1wiLCB7XG4gICAgICAgICAgICB1cmw6IFwiL2RyaW5rc1wiLFxuICAgICAgICAgICAgdGVtcGxhdGU6IFwiPGRyaW5rcy1saXN0PjwvZHJpbmtzLWxpc3Q+XCJcbiAgICAgICAgfSkuc3RhdGUoXCJhcHAubWVhbFwiLCB7XG4gICAgICAgICAgICB1cmw6IFwiL21lYWwvOnBhdGhcIixcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogXCJtZWFsXCIsXG4gICAgICAgICAgICBjb250cm9sbGVyOiBNZWFsQ29udHJvbGxlcixcbiAgICAgICAgICAgIHRlbXBsYXRlOiBcIjxtZWFsLXBhZ2UgaWQ9J21lYWwnIHBhdGg9J3t7IG1lYWwucGF0aCB9fSc+PC9tZWFsLXBhZ2U+XCJcbiAgICAgICAgfSkuc3RhdGUoXCJhcHAuY2FydFwiLCB7XG4gICAgICAgICAgICB1cmw6IFwiL2NhcnRcIixcbiAgICAgICAgICAgIHRlbXBsYXRlOiBcIjxjYXJ0LXBhZ2UgaWQ9J2NhcnQnPjwvY2FydC1wYWdlPlwiXG4gICAgICAgIH0pLnN0YXRlKFwiZXJyb3JcIiwge1xuICAgICAgICAgICAgdXJsOiBcIi9lcnJvclwiLFxuICAgICAgICAgICAgdGVtcGxhdGU6IFwiPGVycm9yLXBhZ2U+PC9lcnJvci1wYWdlPlwiXG4gICAgICAgIH0pO1xuXG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoXCIvYXBwL21haW4vbWVhbHNcIik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gTWVhbENvbnRyb2xsZXIoJHN0YXRlUGFyYW1zKSB7XG4gICAgICAgIHRoaXMucGF0aCA9ICRzdGF0ZVBhcmFtcy5wYXRoO1xuICAgIH1cbn0pKCk7XG5cInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiTWVhbHNcIikuZmFjdG9yeShcIkNhcnRGYWN0b3J5XCIsIENhcnRGYWN0b3J5KTtcblxuICAgIC8qKlxyXG4gICAgICogQG5nZG9jIHNlcnZpY2VcclxuICAgICAqIEBuYW1lIE1lYWxzLkNhcnRGYWN0b3J5XHJcbiAgICAgKlxyXG4gICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgKiBGYWN0b3J5IHdvcmsgd2l0aCBjYXJ0LlxyXG4gICAgICpcclxuICAgICAqKi9cbiAgICBmdW5jdGlvbiBDYXJ0RmFjdG9yeSgpIHtcblxuICAgICAgICB2YXIgY2FydExpc3QgPSBbXSxcbiAgICAgICAgICAgIG1vZGlmaWVycyA9IG51bGwsXG4gICAgICAgICAgICBpbmRleEVkaXRNZWFsID0gMCxcbiAgICAgICAgICAgIGZhY3RvcnkgPSB7XG4gICAgICAgICAgICBnZXRJbmRleEVkaXRNZWFsOiBnZXRJbmRleEVkaXRNZWFsLFxuICAgICAgICAgICAgc2V0SW5kZXhFZGl0TWVhbDogc2V0SW5kZXhFZGl0TWVhbCxcbiAgICAgICAgICAgIGdldENhcnRMaXN0Q291bnQ6IGdldENhcnRMaXN0Q291bnQsXG4gICAgICAgICAgICBhZGRNb2RpZmllcnNUb0xpc3Q6IGFkZE1vZGlmaWVyc1RvTGlzdCxcbiAgICAgICAgICAgIGFkZE1lYWxUb0NhcnRMaXN0OiBhZGRNZWFsVG9DYXJ0TGlzdCxcbiAgICAgICAgICAgIGdldENhcnRMaXN0OiBnZXRDYXJ0TGlzdCxcbiAgICAgICAgICAgIGdldFRvdGFsUHJpY2U6IGdldFRvdGFsUHJpY2UsXG4gICAgICAgICAgICBkZWxldGVNb2RpZmllcnM6IGRlbGV0ZU1vZGlmaWVycyxcbiAgICAgICAgICAgIHJlbW92ZU1lYWw6IHJlbW92ZU1lYWxcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZmFjdG9yeTtcblxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgTWVhbHMuQ2FydEZhY3RvcnkjZ2V0TW9kaWZpZXJzUHJpY2VcclxuICAgICAgICAgKiBAbWV0aG9kT2YgTWVhbHMuQ2FydEZhY3RvcnlcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBSZXR1cm4gdG90YWwgcHJpY2Ugb2YgbW9kaWZpZXJzLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3RbXX0gbW9kaWZpZXJzQXJyIEFycmF5IG9mIG1vZGlmaWVycyBvYmplY3RzLlxyXG4gICAgICAgICAqIEByZXR1cm4ge251bWJlcn0gVG90YWwgcHJpY2UuXHJcbiAgICAgICAgICoqL1xuICAgICAgICBmdW5jdGlvbiBnZXRNb2RpZmllcnNQcmljZShtb2RpZmllcnNBcnIpIHtcbiAgICAgICAgICAgIHZhciB0b3RhbFByaWNlID0gMDtcblxuICAgICAgICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgX2l0ZXJhdG9yRXJyb3IgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yID0gbW9kaWZpZXJzQXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IChfc3RlcCA9IF9pdGVyYXRvci5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbW9kaWZpZXIgPSBfc3RlcC52YWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICB0b3RhbFByaWNlICs9IG1vZGlmaWVyLnByaWNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIF9kaWRJdGVyYXRvckVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvciA9IGVycjtcbiAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uICYmIF9pdGVyYXRvci5yZXR1cm4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvci5yZXR1cm4oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0b3RhbFByaWNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAqIEBuYW1lIE1lYWxzLkNhcnRGYWN0b3J5I2dldEluZGV4RWRpdE1lYWxcclxuICAgICAgICAgKiBAbWV0aG9kT2YgTWVhbHMuQ2FydEZhY3RvcnlcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBSZXR1cm4gaW5kZXggZm8gZWRpdCBtZWFsLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJldHVybiB7bnVtYmVyfSBJbmRleCBvZiBlZGl0IG1lYWwuXHJcbiAgICAgICAgICoqL1xuICAgICAgICBmdW5jdGlvbiBnZXRJbmRleEVkaXRNZWFsKCkge1xuICAgICAgICAgICAgcmV0dXJuIGluZGV4RWRpdE1lYWw7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgTWVhbHMuQ2FydEZhY3Rvcnkjc2V0SW5kZXhFZGl0TWVhbFxyXG4gICAgICAgICAqIEBtZXRob2RPZiBNZWFscy5DYXJ0RmFjdG9yeVxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIFNldCBpbmRleCBvZiBlZGl0IG1lYWwuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXggSW5kZXggb2YgZWRpdCBtZWFsLlxyXG4gICAgICAgICAqKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0SW5kZXhFZGl0TWVhbChpbmRleCkge1xuICAgICAgICAgICAgaW5kZXhFZGl0TWVhbCA9IGluZGV4O1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAqIEBuYW1lIE1lYWxzLkNhcnRGYWN0b3J5I2dldENhcnRMaXN0Q291bnRcclxuICAgICAgICAgKiBAbWV0aG9kT2YgTWVhbHMuQ2FydEZhY3RvcnlcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBSZXR1cm4gY291bnQgb2YgZWxlbWVudHMgaW4gY2FydCBsaXN0LlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJldHVybiB7bnVtYmVyfSBDYXJ0IGxpc3QgbGVuZ3RoLlxyXG4gICAgICAgICAqKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0Q2FydExpc3RDb3VudCgpIHtcbiAgICAgICAgICAgIHJldHVybiBjYXJ0TGlzdC5sZW5ndGg7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgTWVhbHMuQ2FydEZhY3RvcnkjYWRkTW9kaWZpZXJzVG9MaXN0XHJcbiAgICAgICAgICogQG1ldGhvZE9mIE1lYWxzLkNhcnRGYWN0b3J5XHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgICAgICogQWRkIG1vZGlmaWVycyB0byBsaXN0LlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3RbXX0gbW9kaWYgQXJyYXkgd2l0aCBtb2RpZmllcnMgb2JqZWN0cy5cclxuICAgICAgICAgKiovXG4gICAgICAgIGZ1bmN0aW9uIGFkZE1vZGlmaWVyc1RvTGlzdChtb2RpZikge1xuICAgICAgICAgICAgbW9kaWZpZXJzID0gbW9kaWY7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgTWVhbHMuQ2FydEZhY3RvcnkjYWRkTWVhbFRvQ2FydExpc3RcclxuICAgICAgICAgKiBAbWV0aG9kT2YgTWVhbHMuQ2FydEZhY3RvcnlcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBBZGQgbWVhbCB0byBjYXJ0IGxpc3QuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gbWVhbCBNZWFsIG9iamVjdC5cclxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gYW1vdW50IEFtb3VudCBvZiBtZWFsLlxyXG4gICAgICAgICAqKi9cbiAgICAgICAgZnVuY3Rpb24gYWRkTWVhbFRvQ2FydExpc3QobWVhbCwgYW1vdW50KSB7XG4gICAgICAgICAgICB2YXIgbmV3TWVhbCA9IHt9O1xuXG4gICAgICAgICAgICBuZXdNZWFsLmlkID0gbWVhbC5pZDtcbiAgICAgICAgICAgIG5ld01lYWwubmFtZSA9IG1lYWwubmFtZTtcbiAgICAgICAgICAgIG5ld01lYWwucHJpY2UgPSBtZWFsLnByaWNlO1xuICAgICAgICAgICAgbmV3TWVhbC5hbW91bnQgPSBhbW91bnQ7XG5cbiAgICAgICAgICAgIGlmIChtb2RpZmllcnMpIHtcbiAgICAgICAgICAgICAgICBuZXdNZWFsLm1vZGlmaWVycyA9IG1vZGlmaWVycy5zbGljZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtb2RpZmllcnMgPSBudWxsO1xuICAgICAgICAgICAgY2FydExpc3QucHVzaChuZXdNZWFsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSBNZWFscy5DYXJ0RmFjdG9yeSNnZXRDYXJ0TGlzdFxyXG4gICAgICAgICAqIEBtZXRob2RPZiBNZWFscy5DYXJ0RmFjdG9yeVxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIFJldHVybiBjYXJ0IGxpc3QuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmV0dXJuIHtvYmplY3RbXX0gQ2FydCBsaXN0LlxyXG4gICAgICAgICAqKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0Q2FydExpc3QoKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FydExpc3Q7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgTWVhbHMuQ2FydEZhY3RvcnkjZ2V0VG90YWxQcmljZVxyXG4gICAgICAgICAqIEBtZXRob2RPZiBNZWFscy5DYXJ0RmFjdG9yeVxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIFJldHVybiBjYXJ0IGxpc3QgdG90YWwgcHJpY2UuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmV0dXJuIHtudW1iZXJ9IENhcnQgbGlzdCB0b3RhbCBwcmljZS5cclxuICAgICAgICAgKiovXG4gICAgICAgIGZ1bmN0aW9uIGdldFRvdGFsUHJpY2UoKSB7XG4gICAgICAgICAgICB2YXIgdG90YWxQcmljZSA9IDA7XG5cbiAgICAgICAgICAgIGlmIChjYXJ0TGlzdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGNhcnRMaXN0Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdG90YWxQcmljZSArPSBjYXJ0TGlzdFtpXS5wcmljZSAqIGNhcnRMaXN0W2ldLmFtb3VudDtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoY2FydExpc3RbaV0ubW9kaWZpZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbFByaWNlICs9IGdldE1vZGlmaWVyc1ByaWNlKGNhcnRMaXN0W2ldLm1vZGlmaWVycykgKiBjYXJ0TGlzdFtpXS5hbW91bnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0b3RhbFByaWNlLnRvRml4ZWQoMik7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgTWVhbHMuQ2FydEZhY3RvcnkjZGVsZXRlTW9kaWZpZXJzXHJcbiAgICAgICAgICogQG1ldGhvZE9mIE1lYWxzLkNhcnRGYWN0b3J5XHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgICAgICogUmVzZXQgbW9kaWZpZXJzIHZhbHVlLlxyXG4gICAgICAgICAqKi9cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlTW9kaWZpZXJzKCkge1xuICAgICAgICAgICAgbW9kaWZpZXJzID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSBNZWFscy5DYXJ0RmFjdG9yeSNyZW1vdmVNZWFsXHJcbiAgICAgICAgICogQG1ldGhvZE9mIE1lYWxzLkNhcnRGYWN0b3J5XHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgICAgICogUmVtb3ZlIGVkaXQgbWVhbCBvZiBjYXJ0IGxpc3QuXHJcbiAgICAgICAgICoqL1xuICAgICAgICBmdW5jdGlvbiByZW1vdmVNZWFsKCkge1xuICAgICAgICAgICAgY2FydExpc3Quc3BsaWNlKGluZGV4RWRpdE1lYWwsIDEpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTtcblwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24gKCkge1xuXHRcInVzZSBzdHJpY3RcIjtcblxuXHRhbmd1bGFyLm1vZHVsZShcIk1lYWxzXCIpLmZhY3RvcnkoXCJNZWFsc0ZhY3RvcnlcIiwgTWVhbHNGYWN0b3J5KTtcblxuXHQvKipcclxuICAqIEBuZ2RvYyBzZXJ2aWNlXHJcbiAgKiBAbmFtZSBNZWFscy5NZWFsc0ZhY3RvcnlcclxuICAqIEByZXF1aXJlcyAkaHR0cFxyXG4gICogQHJlcXVpcmVzICRxXHJcbiAgKlxyXG4gICogQGRlc2NyaXB0aW9uXHJcbiAgKiBGYWN0b3J5IGdldCBjdXJyZW5jeSwgYXJyYXkgb2YgcHJvZHVjdHMgYW5kIGFycmF5IG9mIGRyaW5rcyxcclxuICAqIGFuZCB3b3JrIHdpdGggY3VycmVudCBtZWFsLlxyXG4gICpcclxuICAqKi9cblx0ZnVuY3Rpb24gTWVhbHNGYWN0b3J5KCRodHRwLCAkcSkge1xuXG5cdFx0dmFyIG1lYWxBcGlVcmwgPSBcIm1lYWxzLmpzb25cIixcblx0XHQgICAgbWVhbHMgPSBudWxsLFxuXHRcdCAgICBjdXJyZW5jeSA9IFwiXCIsXG5cdFx0ICAgIGN1cnJlbnRNZWFsID0gbnVsbCxcblx0XHQgICAgY3VycmVudE1lYWxTdGF0dXMgPSBcIm5ld1wiLFxuXHRcdCAgICBjdXJyZW50QW1vdW50ID0gMSxcblx0XHQgICAgZmFjdG9yeSA9IHtcblx0XHRcdGdldE1vZGlmaWVyczogZ2V0TW9kaWZpZXJzLFxuXHRcdFx0Z2V0TWVhbHM6IGdldE1lYWxzLFxuXHRcdFx0Z2V0Q3VycmVudE1lYWw6IGdldEN1cnJlbnRNZWFsLFxuXHRcdFx0c2V0Q3VycmVudE1lYWw6IHNldEN1cnJlbnRNZWFsLFxuXHRcdFx0Z2V0Q3VycmVudE1lYWxTdGF0dXM6IGdldEN1cnJlbnRNZWFsU3RhdHVzLFxuXHRcdFx0c2V0Q3VycmVudE1lYWxTdGF0dXM6IHNldEN1cnJlbnRNZWFsU3RhdHVzLFxuXHRcdFx0Z2V0Q3VycmVuY3k6IGdldEN1cnJlbmN5LFxuXHRcdFx0Z2V0Q3VycmVudE1lYWxBbW91bnQ6IGdldEN1cnJlbnRNZWFsQW1vdW50LFxuXHRcdFx0c2V0Q3VycmVudE1lYWxBbW91bnQ6IHNldEN1cnJlbnRNZWFsQW1vdW50LFxuXHRcdFx0c2V0Q3VycmVudE1lYWxCeUlkOiBzZXRDdXJyZW50TWVhbEJ5SWQsXG5cdFx0XHRvcGVuTWVhbDogb3Blbk1lYWxcblx0XHR9O1xuXG5cdFx0cmV0dXJuIGZhY3Rvcnk7XG5cblx0XHQvKipcclxuICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICogQG5hbWUgTWVhbHMuTWVhbHNGYWN0b3J5I29wZW5NZWFsXHJcbiAgICogQG1ldGhvZE9mIE1lYWxzLk1lYWxzRmFjdG9yeVxyXG4gICAqXHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICogU2V0IGN1cnJlbnQgbWVhbCwgY3VycmVudCBtZWFsIHN0YXR1cyBhbmQgY3VycmVudCBtZWFsIGFtb3VudC5cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBtZWFsICAgQ3VycmVudCBtZWFsLlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzdGF0dXMgTWVhbCBzdGF0dXMoXCJuZXdcIiBvciBcImVkaXRcIikuXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IGFtb3VudCBNZWFsIGFtb3VudC5cclxuICAgKiovXG5cdFx0ZnVuY3Rpb24gb3Blbk1lYWwobWVhbCwgc3RhdHVzLCBhbW91bnQpIHtcblx0XHRcdHNldEN1cnJlbnRNZWFsKG1lYWwpO1xuXHRcdFx0c2V0Q3VycmVudE1lYWxTdGF0dXMoc3RhdHVzKTtcblx0XHRcdHNldEN1cnJlbnRNZWFsQW1vdW50KGFtb3VudCk7XG5cdFx0fVxuXG5cdFx0LyoqXHJcbiAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAqIEBuYW1lIE1lYWxzLk1lYWxzRmFjdG9yeSNnZXRNZWFsc0Zyb21IdHRwXHJcbiAgICogQG1ldGhvZE9mIE1lYWxzLk1lYWxzRmFjdG9yeVxyXG4gICAqIEBkZXNjcmlwdGlvblxyXG4gICAqIE9idGFpbmluZyBkYXRhIG9uIGZvb2RzIGFuZCBkcmlua3MgZnJvbSB0aGUgc2VydmVyLlxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtvYmplY3R9IGRlZmVycmVkIERlZmVycmVkIG9iamVjdC5cclxuICAgKiBAcmV0dXJuIHtvYmplY3R9IERlZmVycmVkIG9iamVjdCB3aXRoIHJlc29sdmUgYW5kIHJlamVjdC5cclxuICAgKiovXG5cdFx0ZnVuY3Rpb24gZ2V0TWVhbHNGcm9tSHR0cChkZWZlcnJlZCkge1xuXG5cdFx0XHQkaHR0cCh7IG1ldGhvZDogXCJHRVRcIiwgdXJsOiBtZWFsQXBpVXJsIH0pLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcblx0XHRcdFx0bWVhbHMgPSBkYXRhO1xuXHRcdFx0XHRjdXJyZW5jeSA9IGRhdGEuY3VycmVuY3k7XG5cblx0XHRcdFx0ZGVmZXJyZWQucmVzb2x2ZShkYXRhKTtcblx0XHRcdH0pLmVycm9yKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcblx0XHRcdFx0ZGVmZXJyZWQucmVqZWN0KFwiRXJyb3IgaW4gJGh0dHAgcmVxdWVzdFwiKTtcblxuXHRcdFx0XHRjb25zb2xlLmxvZyhkYXRhKTtcblx0XHRcdFx0Y29uc29sZS5sb2coc3RhdHVzKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRyZXR1cm4gZGVmZXJyZWQ7XG5cdFx0fVxuXG5cdFx0LyoqXHJcbiAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAqIEBuYW1lIE1lYWxzLk1lYWxzRmFjdG9yeSNnZXRNb2RpZmllcnNcclxuICAgKiBAbWV0aG9kT2YgTWVhbHMuTWVhbHNGYWN0b3J5XHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICogSWYgbWVhbHMgaGF2ZSBtb2RpZmllcnMgcmV0dXJuIHRoZW0gZWxzZSByZXR1cm4gZmFsc2VcclxuICAgKlxyXG4gICAqIEByZXR1cm4ge29iamVjdHxib29sZWFufSBDdXJyZW50IG1lYWwgbW9kaWZpZXJzIG9yIGZhbHNlLlxyXG4gICAqKi9cblx0XHRmdW5jdGlvbiBnZXRNb2RpZmllcnMoKSB7XG5cblx0XHRcdGlmIChjdXJyZW50TWVhbCAhPT0gbnVsbCkge1xuXHRcdFx0XHRyZXR1cm4gY3VycmVudE1lYWwubW9kaWZpZXJzO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8qKlxyXG4gICAqIEBuZ2RvYyBtZXRob2RcclxuICAgKiBAbmFtZSBNZWFscy5NZWFsc0ZhY3RvcnkjZ2V0TWVhbHNcclxuICAgKiBAbWV0aG9kT2YgTWVhbHMuTWVhbHNGYWN0b3J5XHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICogUmV0dXJuIHByb21pc2Ugd2l0aCB0aGUgcmVzcG9uc2UgcmVjZWl2ZWQgZnJvbSB0aGUgc2VydmVyIG9yXHJcbiAgICogaWYgdGhlIHJlcXVlc3QgaGFzIGFscmVhZHkgYmVlbiwgcmV0dXJuIHByb21pc2Ugd2l0aCB0aGVcclxuICAgKiBtZWFscyBvYmplY3QuXHJcbiAgICpcclxuICAgKiBAcmV0dXJuIHtvYmplY3R9IFByb21pc2UuXHJcbiAgICoqL1xuXHRcdGZ1bmN0aW9uIGdldE1lYWxzKCkge1xuXHRcdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblxuXHRcdFx0aWYgKCFtZWFscykge1xuXHRcdFx0XHRkZWZlcnJlZCA9IGdldE1lYWxzRnJvbUh0dHAoZGVmZXJyZWQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZGVmZXJyZWQucmVzb2x2ZShtZWFscyk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuXHRcdH1cblxuXHRcdC8qKlxyXG4gICAqIEBuZ2RvYyBtZXRob2RcclxuICAgKiBAbmFtZSBNZWFscy5NZWFsc0ZhY3RvcnkjZ2V0Q3VycmVudE1lYWxcclxuICAgKiBAbWV0aG9kT2YgTWVhbHMuTWVhbHNGYWN0b3J5XHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICogUmV0dXJuIGN1cnJlbnQgbWVhbC5cclxuICAgKlxyXG4gICAqIEByZXR1cm4ge29iamVjdH0gQ3VycmVudCBtZWFsLlxyXG4gICAqKi9cblx0XHRmdW5jdGlvbiBnZXRDdXJyZW50TWVhbCgpIHtcblx0XHRcdHJldHVybiBjdXJyZW50TWVhbDtcblx0XHR9XG5cblx0XHQvKipcclxuICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICogQG5hbWUgTWVhbHMuTWVhbHNGYWN0b3J5I3NldEN1cnJlbnRNZWFsXHJcbiAgICogQG1ldGhvZE9mIE1lYWxzLk1lYWxzRmFjdG9yeVxyXG4gICAqIEBkZXNjcmlwdGlvblxyXG4gICAqIFNldCBjdXJyZW50IG1lYWwuXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge29iamVjdH0gbWVhbCBDdXJyZW50IG1lYWwuXHJcbiAgICoqL1xuXHRcdGZ1bmN0aW9uIHNldEN1cnJlbnRNZWFsKG1lYWwpIHtcblx0XHRcdGN1cnJlbnRNZWFsID0gbWVhbDtcblx0XHR9XG5cblx0XHQvKipcclxuICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICogQG5hbWUgTWVhbHMuTWVhbHNGYWN0b3J5I2dldEN1cnJlbnRNZWFsU3RhdHVzXHJcbiAgICogQG1ldGhvZE9mIE1lYWxzLk1lYWxzRmFjdG9yeVxyXG4gICAqIEBkZXNjcmlwdGlvblxyXG4gICAqIFJldHVybiBjdXJyZW50IG1lYWwgc3RhdHVzKFwibmV3XCIgb3IgXCJlZGl0XCIpLlxyXG4gICAqXHJcbiAgICogQHJldHVybiB7c3RyaW5nfSBDdXJyZW50IG1lYWwgc3RhdHVzKFwibmV3XCIgb3IgXCJlZGl0XCIpLlxyXG4gICAqKi9cblx0XHRmdW5jdGlvbiBnZXRDdXJyZW50TWVhbFN0YXR1cygpIHtcblx0XHRcdHJldHVybiBjdXJyZW50TWVhbFN0YXR1cztcblx0XHR9XG5cblx0XHQvKipcclxuICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICogQG5hbWUgTWVhbHMuTWVhbHNGYWN0b3J5I3NldEN1cnJlbnRNZWFsU3RhdHVzXHJcbiAgICogQG1ldGhvZE9mIE1lYWxzLk1lYWxzRmFjdG9yeVxyXG4gICAqIEBkZXNjcmlwdGlvblxyXG4gICAqIFNldCBjdXJyZW50IG1lYWwgc3RhdHVzKFwibmV3XCIgb3IgXCJlZGl0XCIpLlxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IHN0YXR1cyBDdXJyZW50IG1lYWwgc3RhdHVzKFwibmV3XCIgb3IgXCJlZGl0XCIpLlxyXG4gICAqKi9cblx0XHRmdW5jdGlvbiBzZXRDdXJyZW50TWVhbFN0YXR1cyhzdGF0dXMpIHtcblx0XHRcdGN1cnJlbnRNZWFsU3RhdHVzID0gc3RhdHVzO1xuXHRcdH1cblxuXHRcdC8qKlxyXG4gICAqIEBuZ2RvYyBtZXRob2RcclxuICAgKiBAbmFtZSBNZWFscy5NZWFsc0ZhY3RvcnkjZ2V0Q3VycmVuY3lcclxuICAgKiBAbWV0aG9kT2YgTWVhbHMuTWVhbHNGYWN0b3J5XHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICogUmV0dXJuIGN1cnJlbmN5LlxyXG4gICAqXHJcbiAgICogQHJldHVybiB7c3RyaW5nfSBDdXJyZW5jeS5cclxuICAgKiovXG5cdFx0ZnVuY3Rpb24gZ2V0Q3VycmVuY3koKSB7XG5cdFx0XHRyZXR1cm4gY3VycmVuY3k7XG5cdFx0fVxuXG5cdFx0LyoqXHJcbiAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAqIEBuYW1lIE1lYWxzLk1lYWxzRmFjdG9yeSNnZXRDdXJyZW50TWVhbEFtb3VudFxyXG4gICAqIEBtZXRob2RPZiBNZWFscy5NZWFsc0ZhY3RvcnlcclxuICAgKiBAZGVzY3JpcHRpb25cclxuICAgKiBSZXR1cm4gY3VycmVudCBtZWFsIGFtb3VudC5cclxuICAgKlxyXG4gICAqIEByZXR1cm4ge251bWJlcn0gQ3VycmVudCBtZWFsIGFtb3VudC5cclxuICAgKiovXG5cdFx0ZnVuY3Rpb24gZ2V0Q3VycmVudE1lYWxBbW91bnQoKSB7XG5cdFx0XHRyZXR1cm4gY3VycmVudEFtb3VudDtcblx0XHR9XG5cblx0XHQvKipcclxuICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICogQG5hbWUgTWVhbHMuTWVhbHNGYWN0b3J5I3NldEN1cnJlbnRNZWFsQW1vdW50XHJcbiAgICogQG1ldGhvZE9mIE1lYWxzLk1lYWxzRmFjdG9yeVxyXG4gICAqIEBkZXNjcmlwdGlvblxyXG4gICAqIFNldCBjdXJyZW50IG1lYWwgYW1vdW50LlxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IGFtb3VudCBDdXJyZW50IG1lYWwgYW1vdW50LlxyXG4gICAqKi9cblx0XHRmdW5jdGlvbiBzZXRDdXJyZW50TWVhbEFtb3VudChhbW91bnQpIHtcblx0XHRcdGN1cnJlbnRBbW91bnQgPSBhbW91bnQ7XG5cdFx0fVxuXG5cdFx0LyoqXHJcbiAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAqIEBuYW1lIE1lYWxzLk1lYWxzRmFjdG9yeSNzZXRDdXJyZW50TWVhbEJ5SWRcclxuICAgKiBAbWV0aG9kT2YgTWVhbHMuTWVhbHNGYWN0b3J5XHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICogU2V0IGN1cnJlbnQgbWVhbCBieSBpZC5cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBpZCBJZCBvZiBjdXJyZW50IG1lYWwuXHJcbiAgICoqL1xuXHRcdGZ1bmN0aW9uIHNldEN1cnJlbnRNZWFsQnlJZChpZCkge1xuXG5cdFx0XHRjdXJyZW50TWVhbCA9IG1lYWxzLnByb2R1Y3RzLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0XHRyZXR1cm4gaXRlbS5pZCA9PT0gaWQ7XG5cdFx0XHR9KVswXTtcblxuXHRcdFx0aWYgKCFjdXJyZW50TWVhbCkge1xuXHRcdFx0XHRjdXJyZW50TWVhbCA9IG1lYWxzLmRyaW5rcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdFx0XHRyZXR1cm4gaXRlbS5pZCA9PT0gaWQ7XG5cdFx0XHRcdH0pWzBdO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufSkoKTtcblwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJNZWFsc1wiKS5mYWN0b3J5KFwiTW9kaWZpZXJzRmFjdG9yeVwiLCBNb2RpZmllcnNGYWN0b3J5KTtcblxuICAgIC8qKlxyXG4gICAgICogQG5nZG9jIHNlcnZpY2VcclxuICAgICAqIEBuYW1lIE1lYWxzLk1vZGlmaWVyc0ZhY3RvcnlcclxuICAgICAqIEByZXF1aXJlcyBNZWFscy5DYXJ0RmFjdG9yeVxyXG4gICAgICpcclxuICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICogRmFjdG9yeSB3b3JrIHdpdGggbW9kaWZpZXJzLlxyXG4gICAgICpcclxuICAgICAqKi9cbiAgICBmdW5jdGlvbiBNb2RpZmllcnNGYWN0b3J5KENhcnRGYWN0b3J5KSB7XG5cbiAgICAgICAgdmFyIGZhY3RvcnkgPSB7XG4gICAgICAgICAgICBnZXRDaGVja2VkTW9kaWZpZXJzOiBnZXRDaGVja2VkTW9kaWZpZXJzLFxuICAgICAgICAgICAgbW9kaWZpZXJIYXNCZWVuU2VsZWN0ZWQ6IG1vZGlmaWVySGFzQmVlblNlbGVjdGVkLFxuICAgICAgICAgICAgZGVsZXRlTW9kaWZpZXI6IGRlbGV0ZU1vZGlmaWVyLFxuICAgICAgICAgICAgc2VsZWN0TW9kaWZpZXI6IHNlbGVjdE1vZGlmaWVyLFxuICAgICAgICAgICAgcGlja0NoZWNrZWRNb2RpZmllcnM6IHBpY2tDaGVja2VkTW9kaWZpZXJzXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGZhY3Rvcnk7XG5cbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAqIEBuYW1lIE1lYWxzLk1vZGlmaWVyc0ZhY3RvcnkjZ2V0Q2hlY2tlZE1vZGlmaWVyc1xyXG4gICAgICAgICAqIEBtZXRob2RPZiBNZWFscy5Nb2RpZmllcnNGYWN0b3J5XHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgICAgICogUmV0dXJuIGFycmF5IHdpdGggbW9kaWZpZXJzLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJldHVybiB7b2JqZWN0W119IEFycmF5IG9mIG1vZGlmaWVycyBvYmplY3RzLlxyXG4gICAgICAgICAqKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0Q2hlY2tlZE1vZGlmaWVycygpIHtcbiAgICAgICAgICAgIHZhciBjYXJ0TGlzdCA9IENhcnRGYWN0b3J5LmdldENhcnRMaXN0KClbQ2FydEZhY3RvcnkuZ2V0SW5kZXhFZGl0TWVhbCgpXTtcbiAgICAgICAgICAgIHJldHVybiBjYXJ0TGlzdC5tb2RpZmllcnM7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgTWVhbHMuTW9kaWZpZXJzRmFjdG9yeSNtb2RpZmllckhhc0JlZW5TZWxlY3RlZFxyXG4gICAgICAgICAqIEBtZXRob2RPZiBNZWFscy5Nb2RpZmllcnNGYWN0b3J5XHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgICAgICogUmV0dXJuIHRydWUgaWYgbW9kaWZpZXIgaGFzIGJlZW4gc2VsZWN0ZWQsIG9yIGZhbHNlIGlmIG5vLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3RbXX0gc2VsZWN0ZWRNb2RpZmllcnMgQXJyYXkgd2l0aCBzZWxlY3RlZCBtb2RpZmllcnMuXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IG1vZGlmaWVyIE1vZGlmaWVyIG9iamVjdC5cclxuICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIG1vZGlmaWVyIGhhcyBiZWVuIHNlbGVjdGVkLCBlbHNlIGZhbHNlLlxyXG4gICAgICAgICAqKi9cbiAgICAgICAgZnVuY3Rpb24gbW9kaWZpZXJIYXNCZWVuU2VsZWN0ZWQoc2VsZWN0ZWRNb2RpZmllcnMsIG1vZGlmaWVyKSB7XG4gICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRNb2RpZmllcnMuc29tZShmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBtb2RpZmllci5uYW1lID09PSBpdGVtLm5hbWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSBNZWFscy5Nb2RpZmllcnNGYWN0b3J5I2RlbGV0ZU1vZGlmaWVyXHJcbiAgICAgICAgICogQG1ldGhvZE9mIE1lYWxzLk1vZGlmaWVyc0ZhY3RvcnlcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBEZWxldGUgbW9kaWZpZXIgYXQgYXJyYXkgc2VsZWN0ZWQgbW9kaWZpZXJzLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3RbXX0gc2VsZWN0ZWRNb2RpZmllcnMgQXJyYXkgd2l0aCBzZWxlY3RlZCBtb2RpZmllcnMuXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IG1vZGlmaWVyIE1vZGlmaWVyIG9iamVjdCB3aG8gYmUgZGVsZXRlZC5cclxuICAgICAgICAgKiBAcmV0dXJuIHtvYmplY3RbXX0gTmV3IGFycmF5IG9mIG1vZGlmaWVycy5cclxuICAgICAgICAgKiovXG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZU1vZGlmaWVyKHNlbGVjdGVkTW9kaWZpZXJzLCBtb2RpZmllcikge1xuICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkTW9kaWZpZXJzLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBtb2RpZmllci5uYW1lICE9PSBpdGVtLm5hbWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSBNZWFscy5Nb2RpZmllcnNGYWN0b3J5I3NlbGVjdE1vZGlmaWVyXHJcbiAgICAgICAgICogQG1ldGhvZE9mIE1lYWxzLk1vZGlmaWVyc0ZhY3RvcnlcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBBZGQgbW9kaWZpZXIgaWYgaXQgbm90IGhhcyBiZWVuIHNlbGVjdGVkLCBlbHNlIGRlbGV0ZSBtb2RpZmllciBhdFxyXG4gICAgICAgICAqIGFycmF5IG9mIHNlbGVjdGVkIG1vZGlmaWVycy5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0W119IHNlbGVjdGVkTW9kaWZpZXJzIEFycmF5IHdpdGggc2VsZWN0ZWQgbW9kaWZpZXJzLlxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBtb2RpZmllciBNb2RpZmllciBvYmplY3QuXHJcbiAgICAgICAgICoqL1xuICAgICAgICBmdW5jdGlvbiBzZWxlY3RNb2RpZmllcihzZWxlY3RlZE1vZGlmaWVycywgbW9kaWZpZXIpIHtcblxuICAgICAgICAgICAgaWYgKCFtb2RpZmllckhhc0JlZW5TZWxlY3RlZChzZWxlY3RlZE1vZGlmaWVycywgbW9kaWZpZXIpKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRNb2RpZmllcnMucHVzaChtb2RpZmllcik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlbGVjdGVkTW9kaWZpZXJzID0gZGVsZXRlTW9kaWZpZXIoc2VsZWN0ZWRNb2RpZmllcnMsIG1vZGlmaWVyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgQ2FydEZhY3RvcnkuYWRkTW9kaWZpZXJzVG9MaXN0KHNlbGVjdGVkTW9kaWZpZXJzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSBNZWFscy5Nb2RpZmllcnNGYWN0b3J5I3BpY2tDaGVja2VkTW9kaWZpZXJzXHJcbiAgICAgICAgICogQG1ldGhvZE9mIE1lYWxzLk1vZGlmaWVyc0ZhY3RvcnlcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBQaWNrIGFsbCBjaGVja2VkIG1vZGlmaWVycy5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0W119IG1vZGlmaWVycyBBbGwgbW9kaWZpZXJzIG9mIGN1cnJlbnQgbWVhbC5cclxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdFtdfSBzZWxlY3RlZE1vZGlmaWVycyBBcnJheSB3aGVyZSB3aWxsIGJlIHBsYWNlZCBtb2RpZmllcnMuXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3RbXX0gY2hlY2tlZE1vZGlmaWVycyBBcnJheSB3aXRoIGNoZWNrZWQgbW9kaWZpZXJzLlxyXG4gICAgICAgICAqKi9cbiAgICAgICAgZnVuY3Rpb24gcGlja0NoZWNrZWRNb2RpZmllcnMobW9kaWZpZXJzLCBzZWxlY3RlZE1vZGlmaWVycywgY2hlY2tlZE1vZGlmaWVycykge1xuXG4gICAgICAgICAgICBpZiAoY2hlY2tlZE1vZGlmaWVycykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5DaGVja2VkTW9kaWZpZXJzID0gY2hlY2tlZE1vZGlmaWVycy5sZW5ndGg7IGkgPCBsZW5DaGVja2VkTW9kaWZpZXJzOyBpKyspIHtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgbGVuTW9kaWZpZXJzID0gbW9kaWZpZXJzLmxlbmd0aDsgaiA8IGxlbk1vZGlmaWVyczsgaisrKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2RpZmllcnNbal0ubmFtZSA9PT0gY2hlY2tlZE1vZGlmaWVyc1tpXS5uYW1lKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllcnNbal0uY2hlY2sgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE1vZGlmaWVyKHNlbGVjdGVkTW9kaWZpZXJzLCBtb2RpZmllcnNbal0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSkoKTtcblwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJNZWFsc1wiKS5jb21wb25lbnQoXCJhcHBQYWdlXCIsIHtcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwiY29tcG9uZW50LXRlbXBsYXRlcy9hcHAvdGVtcGxhdGUvYXBwUGFnZS5odG1sXCIsXG4gICAgICAgIGJpbmRpbmdzOiB7fSxcbiAgICAgICAgY29udHJvbGxlckFzOiBcImFwcFwiLFxuICAgICAgICBjb250cm9sbGVyOiBBcHBDb250cm9sbGVyXG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiBBcHBDb250cm9sbGVyKCkge31cbn0pKCk7XG5cInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiTWVhbHNcIikuY29tcG9uZW50KFwiY2FydFBhZ2VcIiwge1xuICAgICAgICB0ZW1wbGF0ZVVybDogXCJjb21wb25lbnQtdGVtcGxhdGVzL2NhcnQvdGVtcGxhdGUvY2FydFBhZ2UuaHRtbFwiLFxuICAgICAgICBiaW5kaW5nczoge30sXG4gICAgICAgIGNvbnRyb2xsZXJBczogXCJjYXJ0XCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IENhcnRDb250cm9sbGVyXG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiBDYXJ0Q29udHJvbGxlcihNZWFsc0ZhY3RvcnksIENhcnRGYWN0b3J5KSB7XG5cbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICB2bS5jdXJyZW5jeSA9IE1lYWxzRmFjdG9yeS5nZXRDdXJyZW5jeSgpO1xuICAgICAgICB2bS5jYXJ0TGlzdCA9IENhcnRGYWN0b3J5LmdldENhcnRMaXN0KCk7XG4gICAgICAgIHZtLnRvdGFsUHJpY2UgPSBDYXJ0RmFjdG9yeS5nZXRUb3RhbFByaWNlKCk7XG4gICAgICAgIHZtLmVkaXRNZWFsID0gZWRpdE1lYWw7XG5cbiAgICAgICAgZnVuY3Rpb24gZWRpdE1lYWwobWVhbCwgaW5kZXgpIHtcbiAgICAgICAgICAgIENhcnRGYWN0b3J5LnNldEluZGV4RWRpdE1lYWwoaW5kZXgpO1xuICAgICAgICAgICAgTWVhbHNGYWN0b3J5LnNldEN1cnJlbnRNZWFsQnlJZChtZWFsLmlkKTtcbiAgICAgICAgICAgIE1lYWxzRmFjdG9yeS5zZXRDdXJyZW50TWVhbEFtb3VudChtZWFsLmFtb3VudCk7XG4gICAgICAgICAgICBNZWFsc0ZhY3Rvcnkuc2V0Q3VycmVudE1lYWxTdGF0dXMoXCJlZGl0XCIpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTtcblwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJNZWFsc1wiKS5jb21wb25lbnQoXCJjYXJ0SWNvblBhZ2VcIiwge1xuICAgICAgICB0ZW1wbGF0ZVVybDogXCJjb21wb25lbnQtdGVtcGxhdGVzL2NhcnRJY29uL3RlbXBsYXRlL2NhcnRJY29uUGFnZS5odG1sXCIsXG4gICAgICAgIGJpbmRpbmdzOiB7XG4gICAgICAgICAgICBjb3VudDogXCJAXCJcbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbGxlckFzOiBcImNhcnRJY29uXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IENhcnRJY29uQ29udHJvbGxlclxuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gQ2FydEljb25Db250cm9sbGVyKCkge31cbn0pKCk7XG5cInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiTWVhbHNcIikuY29tcG9uZW50KFwiZHJpbmtzTGlzdFwiLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiBcImNvbXBvbmVudC10ZW1wbGF0ZXMvZHJpbmtzTGlzdC90ZW1wbGF0ZS9kcmlua3NMaXN0Lmh0bWxcIixcbiAgICAgICAgYmluZGluZ3M6IHt9LFxuICAgICAgICBjb250cm9sbGVyQXM6IFwiZHJpbmtzTGlzdFwiLFxuICAgICAgICBjb250cm9sbGVyOiBEcmlua3NMaXN0Q29udHJvbGxlclxuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gRHJpbmtzTGlzdENvbnRyb2xsZXIoTWVhbHNGYWN0b3J5KSB7XG5cbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdmFyIGRyaW5rcyA9IFtdO1xuXG4gICAgICAgIHZtLm9ubHlTb2Z0RHJpbmtzID0gZmFsc2U7XG4gICAgICAgIHZtLmN1cnJlbmN5ID0gXCJcIjtcbiAgICAgICAgdm0ub3BlbkRyaW5rID0gb3BlbkRyaW5rO1xuICAgICAgICB2bS5nZXREcmlua3NGb3JWaWV3ID0gZ2V0RHJpbmtzRm9yVmlldztcblxuICAgICAgICBhY3RpdmF0ZSgpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgICAgICAgTWVhbHNGYWN0b3J5LmdldE1lYWxzKCkudGhlbihnZXREcmlua3MpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0RHJpbmtzKGRyaW5rc09iaikge1xuICAgICAgICAgICAgdm0uY3VycmVuY3kgPSBkcmlua3NPYmouY3VycmVuY3k7XG4gICAgICAgICAgICBkcmlua3MgPSBkcmlua3NPYmouZHJpbmtzO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gb3BlbkRyaW5rKGRyaW5rKSB7XG4gICAgICAgICAgICBNZWFsc0ZhY3Rvcnkub3Blbk1lYWwoZHJpbmssIFwibmV3XCIsIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0RHJpbmtzRm9yVmlldygpIHtcblxuICAgICAgICAgICAgaWYgKHZtLm9ubHlTb2Z0RHJpbmtzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRyaW5rcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0udGlwcGxlICE9PSB0cnVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZHJpbmtzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSkoKTtcblwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJNZWFsc1wiKS5jb21wb25lbnQoXCJlcnJvclBhZ2VcIiwge1xuICAgICAgICB0ZW1wbGF0ZVVybDogXCJjb21wb25lbnQtdGVtcGxhdGVzL2Vycm9yL3RlbXBsYXRlL2Vycm9yUGFnZS5odG1sXCIsXG4gICAgICAgIGJpbmRpbmdzOiB7fSxcbiAgICAgICAgY29udHJvbGxlckFzOiBcImVycm9yXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IEVycm9yQ29udHJvbGxlclxuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gRXJyb3JDb250cm9sbGVyKCkge31cbn0pKCk7XG5cInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiTWVhbHNcIikuY29tcG9uZW50KFwiZm9vdGVyUGFnZVwiLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiBcImNvbXBvbmVudC10ZW1wbGF0ZXMvZm9vdGVyL3RlbXBsYXRlL2Zvb3RlclBhZ2UuaHRtbFwiLFxuICAgICAgICBiaW5kaW5nczoge30sXG4gICAgICAgIGNvbnRyb2xsZXJBczogXCJmb290ZXJcIixcbiAgICAgICAgY29udHJvbGxlcjogRm9vdGVyQ29udHJvbGxlclxuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gRm9vdGVyQ29udHJvbGxlcigpIHt9XG59KSgpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBhbmd1bGFyLm1vZHVsZShcIk1lYWxzXCIpLmNvbXBvbmVudChcImhlYWRlclBhZ2VcIiwge1xuICAgICAgICB0ZW1wbGF0ZVVybDogXCJjb21wb25lbnQtdGVtcGxhdGVzL2hlYWRlci90ZW1wbGF0ZS9oZWFkZXJQYWdlLmh0bWxcIixcbiAgICAgICAgYmluZGluZ3M6IHt9LFxuICAgICAgICBjb250cm9sbGVyQXM6IFwiaGVhZGVyXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IEhlYWRlckNvbnRyb2xsZXJcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIEhlYWRlckNvbnRyb2xsZXIoKSB7fVxufSkoKTtcblwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJNZWFsc1wiKS5jb21wb25lbnQoXCJsb2dvUGFnZVwiLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiBcImNvbXBvbmVudC10ZW1wbGF0ZXMvbG9nby90ZW1wbGF0ZS9sb2dvUGFnZS5odG1sXCIsXG4gICAgICAgIGJpbmRpbmdzOiB7fSxcbiAgICAgICAgY29udHJvbGxlckFzOiBcImxvZ29cIixcbiAgICAgICAgY29udHJvbGxlcjogTG9nb0NvbnRyb2xsZXJcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIExvZ29Db250cm9sbGVyKCkge31cbn0pKCk7XG5cInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiTWVhbHNcIikuY29tcG9uZW50KFwibWFpblBhZ2VcIiwge1xuICAgICAgICB0ZW1wbGF0ZVVybDogXCJjb21wb25lbnQtdGVtcGxhdGVzL21haW4vdGVtcGxhdGUvbWFpblBhZ2UuaHRtbFwiLFxuICAgICAgICBiaW5kaW5nczoge30sXG4gICAgICAgIGNvbnRyb2xsZXJBczogXCJtYWluXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IE1haW5Db250cm9sbGVyXG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiBNYWluQ29udHJvbGxlcigpIHt9XG59KSgpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbihmdW5jdGlvbiAoKSB7XG5cdFwidXNlIHN0cmljdFwiO1xuXG5cdGFuZ3VsYXIubW9kdWxlKFwiTWVhbHNcIikuY29tcG9uZW50KFwibWVhbFBhZ2VcIiwge1xuXHRcdHRlbXBsYXRlVXJsOiBcImNvbXBvbmVudC10ZW1wbGF0ZXMvbWVhbC90ZW1wbGF0ZS9tZWFsUGFnZS5odG1sXCIsXG5cdFx0YmluZGluZ3M6IHtcblx0XHRcdHBhdGg6IFwiQFwiXG5cdFx0fSxcblx0XHRjb250cm9sbGVyQXM6IFwibWVhbFwiLFxuXHRcdGNvbnRyb2xsZXI6IE1lYWxDb250cm9sbGVyXG5cdH0pO1xuXG5cdGZ1bmN0aW9uIE1lYWxDb250cm9sbGVyKE1lYWxzRmFjdG9yeSwgQ2FydEZhY3RvcnkpIHtcblxuXHRcdHZhciB2bSA9IHRoaXM7XG5cblx0XHR2bS5jdXJyZW50TWVhbCA9IE1lYWxzRmFjdG9yeS5nZXRDdXJyZW50TWVhbCgpO1xuXHRcdHZtLmN1cnJlbmN5ID0gTWVhbHNGYWN0b3J5LmdldEN1cnJlbmN5KCk7XG5cdFx0dm0uc2VsZWN0QW1vdW50ID0gTWVhbHNGYWN0b3J5LmdldEN1cnJlbnRNZWFsQW1vdW50KCk7XG5cdFx0dm0ubWVhbFN0YXR1cyA9IE1lYWxzRmFjdG9yeS5nZXRDdXJyZW50TWVhbFN0YXR1cygpO1xuXHRcdHZtLmNhcnRDb3VudCA9IENhcnRGYWN0b3J5LmdldENhcnRMaXN0Q291bnQoKTtcblx0XHR2bS5hZGRNZWFsID0gYWRkTWVhbDtcblx0XHR2bS5yZW1vdmVNZWFsID0gcmVtb3ZlTWVhbDtcblx0XHR2bS5zYXZlTWVhbCA9IHNhdmVNZWFsO1xuXG5cdFx0ZnVuY3Rpb24gYWRkTWVhbCgpIHtcblx0XHRcdENhcnRGYWN0b3J5LmFkZE1lYWxUb0NhcnRMaXN0KHZtLmN1cnJlbnRNZWFsLCB2bS5zZWxlY3RBbW91bnQpO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHJlbW92ZU1lYWwoKSB7XG5cdFx0XHRDYXJ0RmFjdG9yeS5yZW1vdmVNZWFsKCk7XG5cdFx0XHRDYXJ0RmFjdG9yeS5kZWxldGVNb2RpZmllcnMoKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBzYXZlTWVhbCgpIHtcblx0XHRcdENhcnRGYWN0b3J5LnJlbW92ZU1lYWwoKTtcblx0XHRcdHZtLmFkZE1lYWwoKTtcblx0XHR9XG5cdH1cbn0pKCk7XG5cInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cblx0YW5ndWxhci5tb2R1bGUoXCJNZWFsc1wiKS5jb21wb25lbnQoXCJtZWFsc0xpc3RcIiwge1xuXHRcdHRlbXBsYXRlVXJsOiBcImNvbXBvbmVudC10ZW1wbGF0ZXMvbWVhbHNMaXN0L3RlbXBsYXRlL21lYWxzTGlzdC5odG1sXCIsXG5cdFx0YmluZGluZ3M6IHt9LFxuXHRcdGNvbnRyb2xsZXJBczogXCJtZWFsc0xpc3RcIixcblx0XHRjb250cm9sbGVyOiBNZWFsc0xpc3RDb250cm9sbGVyXG5cdH0pO1xuXG5cdGZ1bmN0aW9uIE1lYWxzTGlzdENvbnRyb2xsZXIoTWVhbHNGYWN0b3J5KSB7XG5cblx0XHR2YXIgdm0gPSB0aGlzO1xuXG5cdFx0dm0ub3Blbk1lYWwgPSBvcGVuTWVhbDtcblx0XHR2bS5jdXJyZW5jeSA9IFwiXCI7XG5cdFx0dm0ucHJvZHVjdHMgPSBudWxsO1xuXG5cdFx0YWN0aXZhdGUoKTtcblxuXHRcdGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuXHRcdFx0TWVhbHNGYWN0b3J5LmdldE1lYWxzKCkudGhlbihnZXRQcm9kdWN0cyk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZ2V0UHJvZHVjdHMobWVhbHNPYmopIHtcblx0XHRcdHZtLmN1cnJlbmN5ID0gbWVhbHNPYmouY3VycmVuY3k7XG5cdFx0XHR2bS5wcm9kdWN0cyA9IG1lYWxzT2JqLnByb2R1Y3RzO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIG9wZW5NZWFsKG1lYWwpIHtcblx0XHRcdE1lYWxzRmFjdG9yeS5vcGVuTWVhbChtZWFsLCBcIm5ld1wiLCAxKTtcblx0XHR9XG5cdH1cbn0pKCk7XG5cInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiTWVhbHNcIikuY29tcG9uZW50KFwibWVudVBhZ2VcIiwge1xuICAgICAgICB0ZW1wbGF0ZVVybDogXCJjb21wb25lbnQtdGVtcGxhdGVzL21lbnUvdGVtcGxhdGUvbWVudVBhZ2UuaHRtbFwiLFxuICAgICAgICBiaW5kaW5nczoge30sXG4gICAgICAgIGNvbnRyb2xsZXJBczogXCJtZW51XCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IE1lbnVDb250cm9sbGVyXG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiBNZW51Q29udHJvbGxlcigpIHt9XG59KSgpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBhbmd1bGFyLm1vZHVsZShcIk1lYWxzXCIpLmNvbXBvbmVudChcIm1vZGlmaWVyc1BhZ2VcIiwge1xuICAgICAgICB0ZW1wbGF0ZVVybDogXCJjb21wb25lbnQtdGVtcGxhdGVzL21vZGlmaWVycy90ZW1wbGF0ZS9tb2RpZmllcnNQYWdlLmh0bWxcIixcbiAgICAgICAgYmluZGluZ3M6IHtcbiAgICAgICAgICAgIGN1cnJlbmN5OiBcIkBcIlxuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyQXM6IFwibW9kXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IE1vZGlmaWVyc0NvbnRyb2xsZXJcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIE1vZGlmaWVyc0NvbnRyb2xsZXIoTWVhbHNGYWN0b3J5LCBNb2RpZmllcnNGYWN0b3J5KSB7XG5cbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdmFyIHNlbGVjdGVkTW9kaWZpZXJzID0gW107XG5cbiAgICAgICAgdm0ubW9kaWZpZXJzID0gTWVhbHNGYWN0b3J5LmdldE1vZGlmaWVycygpO1xuICAgICAgICB2bS5zZWxlY3RNb2RpZmllciA9IHNlbGVjdE1vZGlmaWVyO1xuXG4gICAgICAgIGNsZWFuUGlja01vZGlmaWVycygpO1xuXG4gICAgICAgIGlmIChNZWFsc0ZhY3RvcnkuZ2V0Q3VycmVudE1lYWxTdGF0dXMoKSA9PT0gXCJlZGl0XCIpIHtcbiAgICAgICAgICAgIHZhciBjaGVja2VkTW9kaWZpZXJzID0gTW9kaWZpZXJzRmFjdG9yeS5nZXRDaGVja2VkTW9kaWZpZXJzKCk7XG4gICAgICAgICAgICBNb2RpZmllcnNGYWN0b3J5LnBpY2tDaGVja2VkTW9kaWZpZXJzKHZtLm1vZGlmaWVycywgc2VsZWN0ZWRNb2RpZmllcnMsIGNoZWNrZWRNb2RpZmllcnMpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2xlYW5QaWNrTW9kaWZpZXJzKCkge1xuICAgICAgICAgICAgaWYgKHZtLm1vZGlmaWVycykge1xuICAgICAgICAgICAgICAgIHZtLm1vZGlmaWVycy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmNoZWNrID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZWxlY3RNb2RpZmllcihtb2RpZmllcikge1xuICAgICAgICAgICAgTW9kaWZpZXJzRmFjdG9yeS5zZWxlY3RNb2RpZmllcihzZWxlY3RlZE1vZGlmaWVycywgbW9kaWZpZXIpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTtcblwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJNZWFsc1wiKS5jb21wb25lbnQoXCJzZWxlY3RDb3VudFwiLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiBcImNvbXBvbmVudC10ZW1wbGF0ZXMvc2VsZWN0Q291bnQvdGVtcGxhdGUvc2VsZWN0Q291bnRQYWdlLmh0bWxcIixcbiAgICAgICAgYmluZGluZ3M6IHtcbiAgICAgICAgICAgIHNlbGVjdDogXCI9XCJcbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbGxlckFzOiBcInNlbGVjdFwiLFxuICAgICAgICBjb250cm9sbGVyOiBTZWxlY3RDb3VudENvbnRyb2xsZXJcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIFNlbGVjdENvdW50Q29udHJvbGxlcigpIHtcblxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIHZtLnNlbGVjdE51bSA9IHNlbGVjdE51bTtcbiAgICAgICAgdm0uYWN0aXZlTnVtID0gYWN0aXZlTnVtO1xuXG4gICAgICAgIGZ1bmN0aW9uIHNlbGVjdE51bShudW0pIHtcbiAgICAgICAgICAgIHZtLnNlbGVjdCA9IG51bTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2ZU51bShudW0pIHtcbiAgICAgICAgICAgIHJldHVybiB2bS5zZWxlY3QgPT09IG51bTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoXCJNZWFsc1wiLCBbXCJ1aS5yb3V0ZXJcIl0pO1xyXG59KSgpOyIsIihmdW5jdGlvbigpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKFwiTWVhbHNcIilcclxuICAgICAgICAuY29uZmlnKGNvbmZpZyk7XHJcbiAgICBcclxuICAgIGZ1bmN0aW9uIGNvbmZpZygkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XHJcblxyXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXHJcbiAgICAgICAgICAgIC5zdGF0ZShcImFwcFwiLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6IFwiL2FwcFwiLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6IFwiPGFwcC1wYWdlPjwvYXBwLXBhZ2U+XCJcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKFwiYXBwLm1haW5cIiwge1xyXG4gICAgICAgICAgICAgICAgdXJsOiBcIi9tYWluXCIsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogXCI8bWFpbi1wYWdlPjwvbWFpbi1wYWdlPlwiXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZShcImFwcC5tYWluLm1lYWxzXCIsIHtcclxuICAgICAgICAgICAgICAgIHVybDogXCIvbWVhbHNcIixcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBcIjxtZWFscy1saXN0IGlkPSdtZWFsc0xpc3QnPjwvbWVhbHMtbGlzdD5cIlxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoXCJhcHAubWFpbi5kcmlua3NcIiwge1xyXG4gICAgICAgICAgICAgICAgdXJsOiBcIi9kcmlua3NcIixcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBcIjxkcmlua3MtbGlzdD48L2RyaW5rcy1saXN0PlwiXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZShcImFwcC5tZWFsXCIsIHtcclxuICAgICAgICAgICAgICAgIHVybDogXCIvbWVhbC86cGF0aFwiLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiBcIm1lYWxcIixcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IE1lYWxDb250cm9sbGVyLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6IFwiPG1lYWwtcGFnZSBpZD0nbWVhbCcgcGF0aD0ne3sgbWVhbC5wYXRoIH19Jz48L21lYWwtcGFnZT5cIixcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKFwiYXBwLmNhcnRcIiwge1xyXG4gICAgICAgICAgICAgICAgdXJsOiBcIi9jYXJ0XCIsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogXCI8Y2FydC1wYWdlIGlkPSdjYXJ0Jz48L2NhcnQtcGFnZT5cIlxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoXCJlcnJvclwiLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6IFwiL2Vycm9yXCIsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogXCI8ZXJyb3ItcGFnZT48L2Vycm9yLXBhZ2U+XCJcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoXCIvYXBwL21haW4vbWVhbHNcIik7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gTWVhbENvbnRyb2xsZXIoJHN0YXRlUGFyYW1zKSB7XHJcbiAgICAgICAgdGhpcy5wYXRoID0gJHN0YXRlUGFyYW1zLnBhdGg7XHJcbiAgICB9XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoXCJNZWFsc1wiKVxyXG4gICAgICAgIC5mYWN0b3J5KFwiQ2FydEZhY3RvcnlcIiwgQ2FydEZhY3RvcnkpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQG5nZG9jIHNlcnZpY2VcclxuICAgICAqIEBuYW1lIE1lYWxzLkNhcnRGYWN0b3J5XHJcbiAgICAgKlxyXG4gICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgKiBGYWN0b3J5IHdvcmsgd2l0aCBjYXJ0LlxyXG4gICAgICpcclxuICAgICAqKi9cclxuICAgIGZ1bmN0aW9uIENhcnRGYWN0b3J5KCkge1xyXG5cclxuICAgICAgICBsZXQgY2FydExpc3QgICAgICAgICAgPSBbXSxcclxuICAgICAgICAgICAgbW9kaWZpZXJzICAgICAgICAgPSBudWxsLFxyXG4gICAgICAgICAgICBpbmRleEVkaXRNZWFsICAgICA9IDAsXHJcblxyXG4gICAgICAgICAgICBmYWN0b3J5ID0ge1xyXG4gICAgICAgICAgICAgICAgZ2V0SW5kZXhFZGl0TWVhbCAgIDogZ2V0SW5kZXhFZGl0TWVhbCxcclxuICAgICAgICAgICAgICAgIHNldEluZGV4RWRpdE1lYWwgICA6IHNldEluZGV4RWRpdE1lYWwsXHJcbiAgICAgICAgICAgICAgICBnZXRDYXJ0TGlzdENvdW50ICAgOiBnZXRDYXJ0TGlzdENvdW50LFxyXG4gICAgICAgICAgICAgICAgYWRkTW9kaWZpZXJzVG9MaXN0IDogYWRkTW9kaWZpZXJzVG9MaXN0LFxyXG4gICAgICAgICAgICAgICAgYWRkTWVhbFRvQ2FydExpc3QgIDogYWRkTWVhbFRvQ2FydExpc3QsXHJcbiAgICAgICAgICAgICAgICBnZXRDYXJ0TGlzdCAgICAgICAgOiBnZXRDYXJ0TGlzdCxcclxuICAgICAgICAgICAgICAgIGdldFRvdGFsUHJpY2UgICAgICA6IGdldFRvdGFsUHJpY2UsXHJcbiAgICAgICAgICAgICAgICBkZWxldGVNb2RpZmllcnMgICAgOiBkZWxldGVNb2RpZmllcnMsXHJcbiAgICAgICAgICAgICAgICByZW1vdmVNZWFsICAgICAgICAgOiByZW1vdmVNZWFsXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiBmYWN0b3J5O1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgTWVhbHMuQ2FydEZhY3RvcnkjZ2V0TW9kaWZpZXJzUHJpY2VcclxuICAgICAgICAgKiBAbWV0aG9kT2YgTWVhbHMuQ2FydEZhY3RvcnlcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBSZXR1cm4gdG90YWwgcHJpY2Ugb2YgbW9kaWZpZXJzLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3RbXX0gbW9kaWZpZXJzQXJyIEFycmF5IG9mIG1vZGlmaWVycyBvYmplY3RzLlxyXG4gICAgICAgICAqIEByZXR1cm4ge251bWJlcn0gVG90YWwgcHJpY2UuXHJcbiAgICAgICAgICoqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGdldE1vZGlmaWVyc1ByaWNlKG1vZGlmaWVyc0Fycikge1xyXG4gICAgICAgICAgICBsZXQgdG90YWxQcmljZSA9IDA7XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBtb2RpZmllciBvZiBtb2RpZmllcnNBcnIpIHtcclxuICAgICAgICAgICAgICAgIHRvdGFsUHJpY2UgKz0gbW9kaWZpZXIucHJpY2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0b3RhbFByaWNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAqIEBuYW1lIE1lYWxzLkNhcnRGYWN0b3J5I2dldEluZGV4RWRpdE1lYWxcclxuICAgICAgICAgKiBAbWV0aG9kT2YgTWVhbHMuQ2FydEZhY3RvcnlcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBSZXR1cm4gaW5kZXggZm8gZWRpdCBtZWFsLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJldHVybiB7bnVtYmVyfSBJbmRleCBvZiBlZGl0IG1lYWwuXHJcbiAgICAgICAgICoqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGdldEluZGV4RWRpdE1lYWwoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbmRleEVkaXRNZWFsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAqIEBuYW1lIE1lYWxzLkNhcnRGYWN0b3J5I3NldEluZGV4RWRpdE1lYWxcclxuICAgICAgICAgKiBAbWV0aG9kT2YgTWVhbHMuQ2FydEZhY3RvcnlcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBTZXQgaW5kZXggb2YgZWRpdCBtZWFsLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IEluZGV4IG9mIGVkaXQgbWVhbC5cclxuICAgICAgICAgKiovXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0SW5kZXhFZGl0TWVhbChpbmRleCkge1xyXG4gICAgICAgICAgICBpbmRleEVkaXRNZWFsID0gaW5kZXg7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgTWVhbHMuQ2FydEZhY3RvcnkjZ2V0Q2FydExpc3RDb3VudFxyXG4gICAgICAgICAqIEBtZXRob2RPZiBNZWFscy5DYXJ0RmFjdG9yeVxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIFJldHVybiBjb3VudCBvZiBlbGVtZW50cyBpbiBjYXJ0IGxpc3QuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmV0dXJuIHtudW1iZXJ9IENhcnQgbGlzdCBsZW5ndGguXHJcbiAgICAgICAgICoqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGdldENhcnRMaXN0Q291bnQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjYXJ0TGlzdC5sZW5ndGg7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgTWVhbHMuQ2FydEZhY3RvcnkjYWRkTW9kaWZpZXJzVG9MaXN0XHJcbiAgICAgICAgICogQG1ldGhvZE9mIE1lYWxzLkNhcnRGYWN0b3J5XHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgICAgICogQWRkIG1vZGlmaWVycyB0byBsaXN0LlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3RbXX0gbW9kaWYgQXJyYXkgd2l0aCBtb2RpZmllcnMgb2JqZWN0cy5cclxuICAgICAgICAgKiovXHJcbiAgICAgICAgZnVuY3Rpb24gYWRkTW9kaWZpZXJzVG9MaXN0KG1vZGlmKSB7XHJcbiAgICAgICAgICAgIG1vZGlmaWVycyA9IG1vZGlmO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAqIEBuYW1lIE1lYWxzLkNhcnRGYWN0b3J5I2FkZE1lYWxUb0NhcnRMaXN0XHJcbiAgICAgICAgICogQG1ldGhvZE9mIE1lYWxzLkNhcnRGYWN0b3J5XHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgICAgICogQWRkIG1lYWwgdG8gY2FydCBsaXN0LlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IG1lYWwgTWVhbCBvYmplY3QuXHJcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGFtb3VudCBBbW91bnQgb2YgbWVhbC5cclxuICAgICAgICAgKiovXHJcbiAgICAgICAgZnVuY3Rpb24gYWRkTWVhbFRvQ2FydExpc3QobWVhbCwgYW1vdW50KSB7XHJcbiAgICAgICAgICAgIGxldCBuZXdNZWFsID0ge307XHJcblxyXG4gICAgICAgICAgICBuZXdNZWFsLmlkICAgICAgICA9IG1lYWwuaWQ7XHJcbiAgICAgICAgICAgIG5ld01lYWwubmFtZSAgICAgID0gbWVhbC5uYW1lO1xyXG4gICAgICAgICAgICBuZXdNZWFsLnByaWNlICAgICA9IG1lYWwucHJpY2U7XHJcbiAgICAgICAgICAgIG5ld01lYWwuYW1vdW50ICAgID0gYW1vdW50O1xyXG5cclxuICAgICAgICAgICAgaWYgKG1vZGlmaWVycykge1xyXG4gICAgICAgICAgICAgICAgbmV3TWVhbC5tb2RpZmllcnMgPSBtb2RpZmllcnMuc2xpY2UoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbW9kaWZpZXJzID0gbnVsbDtcclxuICAgICAgICAgICAgY2FydExpc3QucHVzaChuZXdNZWFsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSBNZWFscy5DYXJ0RmFjdG9yeSNnZXRDYXJ0TGlzdFxyXG4gICAgICAgICAqIEBtZXRob2RPZiBNZWFscy5DYXJ0RmFjdG9yeVxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIFJldHVybiBjYXJ0IGxpc3QuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmV0dXJuIHtvYmplY3RbXX0gQ2FydCBsaXN0LlxyXG4gICAgICAgICAqKi9cclxuICAgICAgICBmdW5jdGlvbiBnZXRDYXJ0TGlzdCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNhcnRMaXN0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAqIEBuYW1lIE1lYWxzLkNhcnRGYWN0b3J5I2dldFRvdGFsUHJpY2VcclxuICAgICAgICAgKiBAbWV0aG9kT2YgTWVhbHMuQ2FydEZhY3RvcnlcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBSZXR1cm4gY2FydCBsaXN0IHRvdGFsIHByaWNlLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJldHVybiB7bnVtYmVyfSBDYXJ0IGxpc3QgdG90YWwgcHJpY2UuXHJcbiAgICAgICAgICoqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGdldFRvdGFsUHJpY2UoKSB7XHJcbiAgICAgICAgICAgIGxldCB0b3RhbFByaWNlID0gMDtcclxuXHJcbiAgICAgICAgICAgIGlmIChjYXJ0TGlzdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gY2FydExpc3QubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdG90YWxQcmljZSArPSBjYXJ0TGlzdFtpXS5wcmljZSAqIGNhcnRMaXN0W2ldLmFtb3VudDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNhcnRMaXN0W2ldLm1vZGlmaWVycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbFByaWNlICs9IGdldE1vZGlmaWVyc1ByaWNlKGNhcnRMaXN0W2ldLm1vZGlmaWVycykgKiBjYXJ0TGlzdFtpXS5hbW91bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdG90YWxQcmljZS50b0ZpeGVkKDIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAqIEBuYW1lIE1lYWxzLkNhcnRGYWN0b3J5I2RlbGV0ZU1vZGlmaWVyc1xyXG4gICAgICAgICAqIEBtZXRob2RPZiBNZWFscy5DYXJ0RmFjdG9yeVxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIFJlc2V0IG1vZGlmaWVycyB2YWx1ZS5cclxuICAgICAgICAgKiovXHJcbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlTW9kaWZpZXJzKCkge1xyXG4gICAgICAgICAgICBtb2RpZmllcnMgPSBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAqIEBuYW1lIE1lYWxzLkNhcnRGYWN0b3J5I3JlbW92ZU1lYWxcclxuICAgICAgICAgKiBAbWV0aG9kT2YgTWVhbHMuQ2FydEZhY3RvcnlcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBSZW1vdmUgZWRpdCBtZWFsIG9mIGNhcnQgbGlzdC5cclxuICAgICAgICAgKiovXHJcbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlTWVhbCgpIHtcclxuICAgICAgICAgICAgY2FydExpc3Quc3BsaWNlKGluZGV4RWRpdE1lYWwsIDEpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoKTsiLCIoZnVuY3Rpb24oKSB7XHJcblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5cdGFuZ3VsYXJcclxuXHRcdC5tb2R1bGUoXCJNZWFsc1wiKVxyXG5cdFx0LmZhY3RvcnkoXCJNZWFsc0ZhY3RvcnlcIiwgTWVhbHNGYWN0b3J5KTtcclxuXHJcblx0LyoqXHJcblx0ICogQG5nZG9jIHNlcnZpY2VcclxuXHQgKiBAbmFtZSBNZWFscy5NZWFsc0ZhY3RvcnlcclxuXHQgKiBAcmVxdWlyZXMgJGh0dHBcclxuXHQgKiBAcmVxdWlyZXMgJHFcclxuXHQgKlxyXG5cdCAqIEBkZXNjcmlwdGlvblxyXG5cdCAqIEZhY3RvcnkgZ2V0IGN1cnJlbmN5LCBhcnJheSBvZiBwcm9kdWN0cyBhbmQgYXJyYXkgb2YgZHJpbmtzLFxyXG5cdCAqIGFuZCB3b3JrIHdpdGggY3VycmVudCBtZWFsLlxyXG5cdCAqXHJcblx0ICoqL1xyXG5cdGZ1bmN0aW9uIE1lYWxzRmFjdG9yeSgkaHR0cCwgJHEpIHtcclxuXHJcblx0XHRsZXQgbWVhbEFwaVVybCAgICAgICAgPSBcIm1lYWxzLmpzb25cIixcclxuXHRcdFx0bWVhbHMgICAgICAgICAgICAgPSBudWxsLFxyXG5cdFx0XHRjdXJyZW5jeSAgICAgICAgICA9IFwiXCIsXHJcblx0XHRcdGN1cnJlbnRNZWFsICAgICAgID0gbnVsbCxcclxuXHRcdFx0Y3VycmVudE1lYWxTdGF0dXMgPSBcIm5ld1wiLFxyXG5cdFx0XHRjdXJyZW50QW1vdW50ICAgICA9IDEsXHJcblxyXG5cdFx0XHRmYWN0b3J5ID0ge1xyXG5cdFx0XHRcdGdldE1vZGlmaWVycyAgICAgICAgIDogZ2V0TW9kaWZpZXJzLFxyXG5cdFx0XHRcdGdldE1lYWxzICAgICAgICAgICAgIDogZ2V0TWVhbHMsXHJcblx0XHRcdFx0Z2V0Q3VycmVudE1lYWwgICAgICAgOiBnZXRDdXJyZW50TWVhbCxcclxuXHRcdFx0XHRzZXRDdXJyZW50TWVhbCAgICAgICA6IHNldEN1cnJlbnRNZWFsLFxyXG5cdFx0XHRcdGdldEN1cnJlbnRNZWFsU3RhdHVzIDogZ2V0Q3VycmVudE1lYWxTdGF0dXMsXHJcblx0XHRcdFx0c2V0Q3VycmVudE1lYWxTdGF0dXMgOiBzZXRDdXJyZW50TWVhbFN0YXR1cyxcclxuXHRcdFx0XHRnZXRDdXJyZW5jeSAgICAgICAgICA6IGdldEN1cnJlbmN5LFxyXG5cdFx0XHRcdGdldEN1cnJlbnRNZWFsQW1vdW50IDogZ2V0Q3VycmVudE1lYWxBbW91bnQsXHJcblx0XHRcdFx0c2V0Q3VycmVudE1lYWxBbW91bnQgOiBzZXRDdXJyZW50TWVhbEFtb3VudCxcclxuXHRcdFx0XHRzZXRDdXJyZW50TWVhbEJ5SWQgICA6IHNldEN1cnJlbnRNZWFsQnlJZCxcclxuXHRcdFx0XHRvcGVuTWVhbCAgICAgICAgICAgICA6IG9wZW5NZWFsXHJcblx0XHRcdH07XHJcblxyXG5cdFx0cmV0dXJuIGZhY3Rvcnk7XHJcblxyXG5cdFx0LyoqXHJcblx0XHQgKiBAbmdkb2MgbWV0aG9kXHJcblx0XHQgKiBAbmFtZSBNZWFscy5NZWFsc0ZhY3Rvcnkjb3Blbk1lYWxcclxuXHRcdCAqIEBtZXRob2RPZiBNZWFscy5NZWFsc0ZhY3RvcnlcclxuXHRcdCAqXHJcblx0XHQgKiBAZGVzY3JpcHRpb25cclxuXHRcdCAqIFNldCBjdXJyZW50IG1lYWwsIGN1cnJlbnQgbWVhbCBzdGF0dXMgYW5kIGN1cnJlbnQgbWVhbCBhbW91bnQuXHJcblx0XHQgKlxyXG5cdFx0ICogQHBhcmFtIHtvYmplY3R9IG1lYWwgICBDdXJyZW50IG1lYWwuXHJcblx0XHQgKiBAcGFyYW0ge3N0cmluZ30gc3RhdHVzIE1lYWwgc3RhdHVzKFwibmV3XCIgb3IgXCJlZGl0XCIpLlxyXG5cdFx0ICogQHBhcmFtIHtudW1iZXJ9IGFtb3VudCBNZWFsIGFtb3VudC5cclxuXHRcdCAqKi9cclxuXHRcdGZ1bmN0aW9uIG9wZW5NZWFsKG1lYWwsIHN0YXR1cywgYW1vdW50KSB7XHJcblx0XHRcdHNldEN1cnJlbnRNZWFsKG1lYWwpO1xyXG5cdFx0XHRzZXRDdXJyZW50TWVhbFN0YXR1cyhzdGF0dXMpO1xyXG5cdFx0XHRzZXRDdXJyZW50TWVhbEFtb3VudChhbW91bnQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogQG5nZG9jIG1ldGhvZFxyXG5cdFx0ICogQG5hbWUgTWVhbHMuTWVhbHNGYWN0b3J5I2dldE1lYWxzRnJvbUh0dHBcclxuXHRcdCAqIEBtZXRob2RPZiBNZWFscy5NZWFsc0ZhY3RvcnlcclxuXHRcdCAqIEBkZXNjcmlwdGlvblxyXG5cdFx0ICogT2J0YWluaW5nIGRhdGEgb24gZm9vZHMgYW5kIGRyaW5rcyBmcm9tIHRoZSBzZXJ2ZXIuXHJcblx0XHQgKlxyXG5cdFx0ICogQHBhcmFtIHtvYmplY3R9IGRlZmVycmVkIERlZmVycmVkIG9iamVjdC5cclxuXHRcdCAqIEByZXR1cm4ge29iamVjdH0gRGVmZXJyZWQgb2JqZWN0IHdpdGggcmVzb2x2ZSBhbmQgcmVqZWN0LlxyXG5cdFx0ICoqL1xyXG5cdFx0ZnVuY3Rpb24gZ2V0TWVhbHNGcm9tSHR0cChkZWZlcnJlZCkge1xyXG5cclxuXHRcdFx0JGh0dHAoe21ldGhvZCA6IFwiR0VUXCIsIHVybCA6IG1lYWxBcGlVcmx9KVxyXG5cdFx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcblx0XHRcdFx0XHRtZWFscyAgICA9IGRhdGE7XHJcblx0XHRcdFx0XHRjdXJyZW5jeSA9IGRhdGEuY3VycmVuY3k7XHJcblxyXG5cdFx0XHRcdFx0ZGVmZXJyZWQucmVzb2x2ZShkYXRhKTtcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHRcdC5lcnJvcihmdW5jdGlvbiAoZGF0YSwgc3RhdHVzKSB7XHJcblx0XHRcdFx0XHRkZWZlcnJlZC5yZWplY3QoXCJFcnJvciBpbiAkaHR0cCByZXF1ZXN0XCIpO1xyXG5cclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKGRhdGEpO1xyXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coc3RhdHVzKTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdHJldHVybiBkZWZlcnJlZDtcclxuXHRcdH1cclxuXHJcblx0XHQvKipcclxuXHRcdCAqIEBuZ2RvYyBtZXRob2RcclxuXHRcdCAqIEBuYW1lIE1lYWxzLk1lYWxzRmFjdG9yeSNnZXRNb2RpZmllcnNcclxuXHRcdCAqIEBtZXRob2RPZiBNZWFscy5NZWFsc0ZhY3RvcnlcclxuXHRcdCAqIEBkZXNjcmlwdGlvblxyXG5cdFx0ICogSWYgbWVhbHMgaGF2ZSBtb2RpZmllcnMgcmV0dXJuIHRoZW0gZWxzZSByZXR1cm4gZmFsc2VcclxuXHRcdCAqXHJcblx0XHQgKiBAcmV0dXJuIHtvYmplY3R8Ym9vbGVhbn0gQ3VycmVudCBtZWFsIG1vZGlmaWVycyBvciBmYWxzZS5cclxuXHRcdCAqKi9cclxuXHRcdGZ1bmN0aW9uIGdldE1vZGlmaWVycygpIHtcclxuXHJcblx0XHRcdGlmIChjdXJyZW50TWVhbCAhPT0gbnVsbCkge1xyXG5cdFx0XHRcdHJldHVybiBjdXJyZW50TWVhbC5tb2RpZmllcnM7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0LyoqXHJcblx0XHQgKiBAbmdkb2MgbWV0aG9kXHJcblx0XHQgKiBAbmFtZSBNZWFscy5NZWFsc0ZhY3RvcnkjZ2V0TWVhbHNcclxuXHRcdCAqIEBtZXRob2RPZiBNZWFscy5NZWFsc0ZhY3RvcnlcclxuXHRcdCAqIEBkZXNjcmlwdGlvblxyXG5cdFx0ICogUmV0dXJuIHByb21pc2Ugd2l0aCB0aGUgcmVzcG9uc2UgcmVjZWl2ZWQgZnJvbSB0aGUgc2VydmVyIG9yXHJcblx0XHQgKiBpZiB0aGUgcmVxdWVzdCBoYXMgYWxyZWFkeSBiZWVuLCByZXR1cm4gcHJvbWlzZSB3aXRoIHRoZVxyXG5cdFx0ICogbWVhbHMgb2JqZWN0LlxyXG5cdFx0ICpcclxuXHRcdCAqIEByZXR1cm4ge29iamVjdH0gUHJvbWlzZS5cclxuXHRcdCAqKi9cclxuXHRcdGZ1bmN0aW9uIGdldE1lYWxzKCkge1xyXG5cdFx0XHRsZXQgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xyXG5cclxuXHRcdFx0aWYgKCFtZWFscykge1xyXG5cdFx0XHRcdGRlZmVycmVkID0gZ2V0TWVhbHNGcm9tSHR0cChkZWZlcnJlZCk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0ZGVmZXJyZWQucmVzb2x2ZShtZWFscyk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogQG5nZG9jIG1ldGhvZFxyXG5cdFx0ICogQG5hbWUgTWVhbHMuTWVhbHNGYWN0b3J5I2dldEN1cnJlbnRNZWFsXHJcblx0XHQgKiBAbWV0aG9kT2YgTWVhbHMuTWVhbHNGYWN0b3J5XHJcblx0XHQgKiBAZGVzY3JpcHRpb25cclxuXHRcdCAqIFJldHVybiBjdXJyZW50IG1lYWwuXHJcblx0XHQgKlxyXG5cdFx0ICogQHJldHVybiB7b2JqZWN0fSBDdXJyZW50IG1lYWwuXHJcblx0XHQgKiovXHJcblx0XHRmdW5jdGlvbiBnZXRDdXJyZW50TWVhbCgpIHtcclxuXHRcdFx0cmV0dXJuIGN1cnJlbnRNZWFsO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogQG5nZG9jIG1ldGhvZFxyXG5cdFx0ICogQG5hbWUgTWVhbHMuTWVhbHNGYWN0b3J5I3NldEN1cnJlbnRNZWFsXHJcblx0XHQgKiBAbWV0aG9kT2YgTWVhbHMuTWVhbHNGYWN0b3J5XHJcblx0XHQgKiBAZGVzY3JpcHRpb25cclxuXHRcdCAqIFNldCBjdXJyZW50IG1lYWwuXHJcblx0XHQgKlxyXG5cdFx0ICogQHBhcmFtIHtvYmplY3R9IG1lYWwgQ3VycmVudCBtZWFsLlxyXG5cdFx0ICoqL1xyXG5cdFx0ZnVuY3Rpb24gc2V0Q3VycmVudE1lYWwobWVhbCkge1xyXG5cdFx0XHRjdXJyZW50TWVhbCA9IG1lYWw7XHJcblx0XHR9XHJcblxyXG5cdFx0LyoqXHJcblx0XHQgKiBAbmdkb2MgbWV0aG9kXHJcblx0XHQgKiBAbmFtZSBNZWFscy5NZWFsc0ZhY3RvcnkjZ2V0Q3VycmVudE1lYWxTdGF0dXNcclxuXHRcdCAqIEBtZXRob2RPZiBNZWFscy5NZWFsc0ZhY3RvcnlcclxuXHRcdCAqIEBkZXNjcmlwdGlvblxyXG5cdFx0ICogUmV0dXJuIGN1cnJlbnQgbWVhbCBzdGF0dXMoXCJuZXdcIiBvciBcImVkaXRcIikuXHJcblx0XHQgKlxyXG5cdFx0ICogQHJldHVybiB7c3RyaW5nfSBDdXJyZW50IG1lYWwgc3RhdHVzKFwibmV3XCIgb3IgXCJlZGl0XCIpLlxyXG5cdFx0ICoqL1xyXG5cdFx0ZnVuY3Rpb24gZ2V0Q3VycmVudE1lYWxTdGF0dXMoKSB7XHJcblx0XHRcdHJldHVybiBjdXJyZW50TWVhbFN0YXR1cztcclxuXHRcdH1cclxuXHJcblx0XHQvKipcclxuXHRcdCAqIEBuZ2RvYyBtZXRob2RcclxuXHRcdCAqIEBuYW1lIE1lYWxzLk1lYWxzRmFjdG9yeSNzZXRDdXJyZW50TWVhbFN0YXR1c1xyXG5cdFx0ICogQG1ldGhvZE9mIE1lYWxzLk1lYWxzRmFjdG9yeVxyXG5cdFx0ICogQGRlc2NyaXB0aW9uXHJcblx0XHQgKiBTZXQgY3VycmVudCBtZWFsIHN0YXR1cyhcIm5ld1wiIG9yIFwiZWRpdFwiKS5cclxuXHRcdCAqXHJcblx0XHQgKiBAcGFyYW0ge3N0cmluZ30gc3RhdHVzIEN1cnJlbnQgbWVhbCBzdGF0dXMoXCJuZXdcIiBvciBcImVkaXRcIikuXHJcblx0XHQgKiovXHJcblx0XHRmdW5jdGlvbiBzZXRDdXJyZW50TWVhbFN0YXR1cyhzdGF0dXMpIHtcclxuXHRcdFx0Y3VycmVudE1lYWxTdGF0dXMgPSBzdGF0dXM7XHJcblx0XHR9XHJcblxyXG5cdFx0LyoqXHJcblx0XHQgKiBAbmdkb2MgbWV0aG9kXHJcblx0XHQgKiBAbmFtZSBNZWFscy5NZWFsc0ZhY3RvcnkjZ2V0Q3VycmVuY3lcclxuXHRcdCAqIEBtZXRob2RPZiBNZWFscy5NZWFsc0ZhY3RvcnlcclxuXHRcdCAqIEBkZXNjcmlwdGlvblxyXG5cdFx0ICogUmV0dXJuIGN1cnJlbmN5LlxyXG5cdFx0ICpcclxuXHRcdCAqIEByZXR1cm4ge3N0cmluZ30gQ3VycmVuY3kuXHJcblx0XHQgKiovXHJcblx0XHRmdW5jdGlvbiBnZXRDdXJyZW5jeSgpIHtcclxuXHRcdFx0cmV0dXJuIGN1cnJlbmN5O1xyXG5cdFx0fVxyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogQG5nZG9jIG1ldGhvZFxyXG5cdFx0ICogQG5hbWUgTWVhbHMuTWVhbHNGYWN0b3J5I2dldEN1cnJlbnRNZWFsQW1vdW50XHJcblx0XHQgKiBAbWV0aG9kT2YgTWVhbHMuTWVhbHNGYWN0b3J5XHJcblx0XHQgKiBAZGVzY3JpcHRpb25cclxuXHRcdCAqIFJldHVybiBjdXJyZW50IG1lYWwgYW1vdW50LlxyXG5cdFx0ICpcclxuXHRcdCAqIEByZXR1cm4ge251bWJlcn0gQ3VycmVudCBtZWFsIGFtb3VudC5cclxuXHRcdCAqKi9cclxuXHRcdGZ1bmN0aW9uIGdldEN1cnJlbnRNZWFsQW1vdW50KCkge1xyXG5cdFx0XHRyZXR1cm4gY3VycmVudEFtb3VudDtcclxuXHRcdH1cclxuXHJcblx0XHQvKipcclxuXHRcdCAqIEBuZ2RvYyBtZXRob2RcclxuXHRcdCAqIEBuYW1lIE1lYWxzLk1lYWxzRmFjdG9yeSNzZXRDdXJyZW50TWVhbEFtb3VudFxyXG5cdFx0ICogQG1ldGhvZE9mIE1lYWxzLk1lYWxzRmFjdG9yeVxyXG5cdFx0ICogQGRlc2NyaXB0aW9uXHJcblx0XHQgKiBTZXQgY3VycmVudCBtZWFsIGFtb3VudC5cclxuXHRcdCAqXHJcblx0XHQgKiBAcGFyYW0ge251bWJlcn0gYW1vdW50IEN1cnJlbnQgbWVhbCBhbW91bnQuXHJcblx0XHQgKiovXHJcblx0XHRmdW5jdGlvbiBzZXRDdXJyZW50TWVhbEFtb3VudChhbW91bnQpIHtcclxuXHRcdFx0Y3VycmVudEFtb3VudCA9IGFtb3VudDtcclxuXHRcdH1cclxuXHJcblx0XHQvKipcclxuXHRcdCAqIEBuZ2RvYyBtZXRob2RcclxuXHRcdCAqIEBuYW1lIE1lYWxzLk1lYWxzRmFjdG9yeSNzZXRDdXJyZW50TWVhbEJ5SWRcclxuXHRcdCAqIEBtZXRob2RPZiBNZWFscy5NZWFsc0ZhY3RvcnlcclxuXHRcdCAqIEBkZXNjcmlwdGlvblxyXG5cdFx0ICogU2V0IGN1cnJlbnQgbWVhbCBieSBpZC5cclxuXHRcdCAqXHJcblx0XHQgKiBAcGFyYW0ge3N0cmluZ30gaWQgSWQgb2YgY3VycmVudCBtZWFsLlxyXG5cdFx0ICoqL1xyXG5cdFx0ZnVuY3Rpb24gc2V0Q3VycmVudE1lYWxCeUlkKGlkKSB7XHJcblxyXG5cdFx0XHRjdXJyZW50TWVhbCA9IG1lYWxzLnByb2R1Y3RzLmZpbHRlcigoaXRlbSkgPT4gaXRlbS5pZCA9PT0gaWQpWzBdO1xyXG5cclxuXHRcdFx0aWYgKCFjdXJyZW50TWVhbCkge1xyXG5cdFx0XHRcdGN1cnJlbnRNZWFsID0gbWVhbHMuZHJpbmtzLmZpbHRlcigoaXRlbSkgPT4gaXRlbS5pZCA9PT0gaWQpWzBdO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59KSgpOyIsIihmdW5jdGlvbigpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKFwiTWVhbHNcIilcclxuICAgICAgICAuZmFjdG9yeShcIk1vZGlmaWVyc0ZhY3RvcnlcIiwgTW9kaWZpZXJzRmFjdG9yeSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAbmdkb2Mgc2VydmljZVxyXG4gICAgICogQG5hbWUgTWVhbHMuTW9kaWZpZXJzRmFjdG9yeVxyXG4gICAgICogQHJlcXVpcmVzIE1lYWxzLkNhcnRGYWN0b3J5XHJcbiAgICAgKlxyXG4gICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgKiBGYWN0b3J5IHdvcmsgd2l0aCBtb2RpZmllcnMuXHJcbiAgICAgKlxyXG4gICAgICoqL1xyXG4gICAgZnVuY3Rpb24gTW9kaWZpZXJzRmFjdG9yeShDYXJ0RmFjdG9yeSkge1xyXG5cclxuICAgICAgICBsZXQgZmFjdG9yeSA9IHtcclxuICAgICAgICAgICAgZ2V0Q2hlY2tlZE1vZGlmaWVycyAgICAgOiBnZXRDaGVja2VkTW9kaWZpZXJzLFxyXG4gICAgICAgICAgICBtb2RpZmllckhhc0JlZW5TZWxlY3RlZCA6IG1vZGlmaWVySGFzQmVlblNlbGVjdGVkLFxyXG4gICAgICAgICAgICBkZWxldGVNb2RpZmllciAgICAgICAgICA6IGRlbGV0ZU1vZGlmaWVyLFxyXG4gICAgICAgICAgICBzZWxlY3RNb2RpZmllciAgICAgICAgICA6IHNlbGVjdE1vZGlmaWVyLFxyXG4gICAgICAgICAgICBwaWNrQ2hlY2tlZE1vZGlmaWVycyAgICA6IHBpY2tDaGVja2VkTW9kaWZpZXJzXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGZhY3Rvcnk7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSBNZWFscy5Nb2RpZmllcnNGYWN0b3J5I2dldENoZWNrZWRNb2RpZmllcnNcclxuICAgICAgICAgKiBAbWV0aG9kT2YgTWVhbHMuTW9kaWZpZXJzRmFjdG9yeVxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIFJldHVybiBhcnJheSB3aXRoIG1vZGlmaWVycy5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZXR1cm4ge29iamVjdFtdfSBBcnJheSBvZiBtb2RpZmllcnMgb2JqZWN0cy5cclxuICAgICAgICAgKiovXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0Q2hlY2tlZE1vZGlmaWVycygpIHtcclxuICAgICAgICAgICAgbGV0IGNhcnRMaXN0ID0gQ2FydEZhY3RvcnkuZ2V0Q2FydExpc3QoKVtDYXJ0RmFjdG9yeS5nZXRJbmRleEVkaXRNZWFsKCldO1xyXG4gICAgICAgICAgICByZXR1cm4gY2FydExpc3QubW9kaWZpZXJzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAqIEBuYW1lIE1lYWxzLk1vZGlmaWVyc0ZhY3RvcnkjbW9kaWZpZXJIYXNCZWVuU2VsZWN0ZWRcclxuICAgICAgICAgKiBAbWV0aG9kT2YgTWVhbHMuTW9kaWZpZXJzRmFjdG9yeVxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIFJldHVybiB0cnVlIGlmIG1vZGlmaWVyIGhhcyBiZWVuIHNlbGVjdGVkLCBvciBmYWxzZSBpZiBuby5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0W119IHNlbGVjdGVkTW9kaWZpZXJzIEFycmF5IHdpdGggc2VsZWN0ZWQgbW9kaWZpZXJzLlxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBtb2RpZmllciBNb2RpZmllciBvYmplY3QuXHJcbiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiBtb2RpZmllciBoYXMgYmVlbiBzZWxlY3RlZCwgZWxzZSBmYWxzZS5cclxuICAgICAgICAgKiovXHJcbiAgICAgICAgZnVuY3Rpb24gbW9kaWZpZXJIYXNCZWVuU2VsZWN0ZWQoc2VsZWN0ZWRNb2RpZmllcnMsIG1vZGlmaWVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzZWxlY3RlZE1vZGlmaWVycy5zb21lKChpdGVtKSA9PiBtb2RpZmllci5uYW1lID09PSBpdGVtLm5hbWUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAqIEBuYW1lIE1lYWxzLk1vZGlmaWVyc0ZhY3RvcnkjZGVsZXRlTW9kaWZpZXJcclxuICAgICAgICAgKiBAbWV0aG9kT2YgTWVhbHMuTW9kaWZpZXJzRmFjdG9yeVxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIERlbGV0ZSBtb2RpZmllciBhdCBhcnJheSBzZWxlY3RlZCBtb2RpZmllcnMuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdFtdfSBzZWxlY3RlZE1vZGlmaWVycyBBcnJheSB3aXRoIHNlbGVjdGVkIG1vZGlmaWVycy5cclxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gbW9kaWZpZXIgTW9kaWZpZXIgb2JqZWN0IHdobyBiZSBkZWxldGVkLlxyXG4gICAgICAgICAqIEByZXR1cm4ge29iamVjdFtdfSBOZXcgYXJyYXkgb2YgbW9kaWZpZXJzLlxyXG4gICAgICAgICAqKi9cclxuICAgICAgICBmdW5jdGlvbiBkZWxldGVNb2RpZmllcihzZWxlY3RlZE1vZGlmaWVycywgbW9kaWZpZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkTW9kaWZpZXJzLmZpbHRlcigoaXRlbSkgPT4gbW9kaWZpZXIubmFtZSAhPT0gaXRlbS5uYW1lKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSBNZWFscy5Nb2RpZmllcnNGYWN0b3J5I3NlbGVjdE1vZGlmaWVyXHJcbiAgICAgICAgICogQG1ldGhvZE9mIE1lYWxzLk1vZGlmaWVyc0ZhY3RvcnlcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBBZGQgbW9kaWZpZXIgaWYgaXQgbm90IGhhcyBiZWVuIHNlbGVjdGVkLCBlbHNlIGRlbGV0ZSBtb2RpZmllciBhdFxyXG4gICAgICAgICAqIGFycmF5IG9mIHNlbGVjdGVkIG1vZGlmaWVycy5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0W119IHNlbGVjdGVkTW9kaWZpZXJzIEFycmF5IHdpdGggc2VsZWN0ZWQgbW9kaWZpZXJzLlxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBtb2RpZmllciBNb2RpZmllciBvYmplY3QuXHJcbiAgICAgICAgICoqL1xyXG4gICAgICAgIGZ1bmN0aW9uIHNlbGVjdE1vZGlmaWVyKHNlbGVjdGVkTW9kaWZpZXJzLCBtb2RpZmllcikge1xyXG5cclxuICAgICAgICAgICAgaWYgKCFtb2RpZmllckhhc0JlZW5TZWxlY3RlZChzZWxlY3RlZE1vZGlmaWVycywgbW9kaWZpZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZE1vZGlmaWVycy5wdXNoKG1vZGlmaWVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkTW9kaWZpZXJzID0gZGVsZXRlTW9kaWZpZXIoc2VsZWN0ZWRNb2RpZmllcnMsIG1vZGlmaWVyKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgQ2FydEZhY3RvcnkuYWRkTW9kaWZpZXJzVG9MaXN0KHNlbGVjdGVkTW9kaWZpZXJzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSBNZWFscy5Nb2RpZmllcnNGYWN0b3J5I3BpY2tDaGVja2VkTW9kaWZpZXJzXHJcbiAgICAgICAgICogQG1ldGhvZE9mIE1lYWxzLk1vZGlmaWVyc0ZhY3RvcnlcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBQaWNrIGFsbCBjaGVja2VkIG1vZGlmaWVycy5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0W119IG1vZGlmaWVycyBBbGwgbW9kaWZpZXJzIG9mIGN1cnJlbnQgbWVhbC5cclxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdFtdfSBzZWxlY3RlZE1vZGlmaWVycyBBcnJheSB3aGVyZSB3aWxsIGJlIHBsYWNlZCBtb2RpZmllcnMuXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3RbXX0gY2hlY2tlZE1vZGlmaWVycyBBcnJheSB3aXRoIGNoZWNrZWQgbW9kaWZpZXJzLlxyXG4gICAgICAgICAqKi9cclxuICAgICAgICBmdW5jdGlvbiBwaWNrQ2hlY2tlZE1vZGlmaWVycyhtb2RpZmllcnMsIHNlbGVjdGVkTW9kaWZpZXJzLCBjaGVja2VkTW9kaWZpZXJzKSB7XHJcblxyXG4gICAgICAgICAgICBpZiAoY2hlY2tlZE1vZGlmaWVycykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbkNoZWNrZWRNb2RpZmllcnMgPSBjaGVja2VkTW9kaWZpZXJzLmxlbmd0aDsgaSA8IGxlbkNoZWNrZWRNb2RpZmllcnM7IGkrKykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMCwgbGVuTW9kaWZpZXJzID0gbW9kaWZpZXJzLmxlbmd0aDsgaiA8IGxlbk1vZGlmaWVyczsgaisrKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kaWZpZXJzW2pdLm5hbWUgPT09IGNoZWNrZWRNb2RpZmllcnNbaV0ubmFtZSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyc1tqXS5jaGVjayA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RNb2RpZmllcihzZWxlY3RlZE1vZGlmaWVycywgbW9kaWZpZXJzW2pdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoXCJNZWFsc1wiKVxyXG4gICAgICAgIC5jb21wb25lbnQoXCJhcHBQYWdlXCIsIHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmwgOiBcImNvbXBvbmVudC10ZW1wbGF0ZXMvYXBwL3RlbXBsYXRlL2FwcFBhZ2UuaHRtbFwiLFxyXG4gICAgICAgICAgICBiaW5kaW5ncyA6IHt9LFxyXG4gICAgICAgICAgICBjb250cm9sbGVyQXMgOiBcImFwcFwiLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyIDogQXBwQ29udHJvbGxlclxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIGZ1bmN0aW9uIEFwcENvbnRyb2xsZXIoKSB7fVxyXG59KSgpOyIsIihmdW5jdGlvbigpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKFwiTWVhbHNcIilcclxuICAgICAgICAuY29tcG9uZW50KFwiY2FydFBhZ2VcIiwge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybCA6IFwiY29tcG9uZW50LXRlbXBsYXRlcy9jYXJ0L3RlbXBsYXRlL2NhcnRQYWdlLmh0bWxcIixcclxuICAgICAgICAgICAgYmluZGluZ3MgOiB7fSxcclxuICAgICAgICAgICAgY29udHJvbGxlckFzIDogXCJjYXJ0XCIsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXIgOiBDYXJ0Q29udHJvbGxlclxyXG4gICAgICAgIH0pO1xyXG4gICAgXHJcbiAgICBmdW5jdGlvbiBDYXJ0Q29udHJvbGxlcihNZWFsc0ZhY3RvcnksIENhcnRGYWN0b3J5KSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3Qgdm0gPSB0aGlzO1xyXG5cclxuICAgICAgICB2bS5jdXJyZW5jeSAgID0gTWVhbHNGYWN0b3J5LmdldEN1cnJlbmN5KCk7XHJcbiAgICAgICAgdm0uY2FydExpc3QgICA9IENhcnRGYWN0b3J5LmdldENhcnRMaXN0KCk7XHJcbiAgICAgICAgdm0udG90YWxQcmljZSA9IENhcnRGYWN0b3J5LmdldFRvdGFsUHJpY2UoKTtcclxuICAgICAgICB2bS5lZGl0TWVhbCAgID0gZWRpdE1lYWw7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVkaXRNZWFsKG1lYWwsIGluZGV4KSB7XHJcbiAgICAgICAgICAgIENhcnRGYWN0b3J5LnNldEluZGV4RWRpdE1lYWwoaW5kZXgpO1xyXG4gICAgICAgICAgICBNZWFsc0ZhY3Rvcnkuc2V0Q3VycmVudE1lYWxCeUlkKG1lYWwuaWQpO1xyXG4gICAgICAgICAgICBNZWFsc0ZhY3Rvcnkuc2V0Q3VycmVudE1lYWxBbW91bnQobWVhbC5hbW91bnQpO1xyXG4gICAgICAgICAgICBNZWFsc0ZhY3Rvcnkuc2V0Q3VycmVudE1lYWxTdGF0dXMoXCJlZGl0XCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoKTsiLCIoZnVuY3Rpb24oKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZShcIk1lYWxzXCIpXHJcbiAgICAgICAgLmNvbXBvbmVudChcImNhcnRJY29uUGFnZVwiLCB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsIDogXCJjb21wb25lbnQtdGVtcGxhdGVzL2NhcnRJY29uL3RlbXBsYXRlL2NhcnRJY29uUGFnZS5odG1sXCIsXHJcbiAgICAgICAgICAgIGJpbmRpbmdzIDoge1xyXG4gICAgICAgICAgICAgICAgY291bnQ6IFwiQFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBcyA6IFwiY2FydEljb25cIixcclxuICAgICAgICAgICAgY29udHJvbGxlciA6IENhcnRJY29uQ29udHJvbGxlclxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIGZ1bmN0aW9uIENhcnRJY29uQ29udHJvbGxlcigpIHt9XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoXCJNZWFsc1wiKVxyXG4gICAgICAgIC5jb21wb25lbnQoXCJkcmlua3NMaXN0XCIsIHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmwgOiBcImNvbXBvbmVudC10ZW1wbGF0ZXMvZHJpbmtzTGlzdC90ZW1wbGF0ZS9kcmlua3NMaXN0Lmh0bWxcIixcclxuICAgICAgICAgICAgYmluZGluZ3MgOiB7fSxcclxuICAgICAgICAgICAgY29udHJvbGxlckFzIDogXCJkcmlua3NMaXN0XCIsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXIgOiBEcmlua3NMaXN0Q29udHJvbGxlclxyXG4gICAgICAgIH0pO1xyXG4gICAgXHJcbiAgICBmdW5jdGlvbiBEcmlua3NMaXN0Q29udHJvbGxlcihNZWFsc0ZhY3RvcnkpIHtcclxuXHJcbiAgICAgICAgY29uc3Qgdm0gICAgID0gdGhpcztcclxuICAgICAgICBsZXQgICBkcmlua3MgPSBbXTtcclxuXHJcbiAgICAgICAgdm0ub25seVNvZnREcmlua3MgICA9IGZhbHNlO1xyXG4gICAgICAgIHZtLmN1cnJlbmN5ICAgICAgICAgPSBcIlwiO1xyXG4gICAgICAgIHZtLm9wZW5EcmluayAgICAgICAgPSBvcGVuRHJpbms7XHJcbiAgICAgICAgdm0uZ2V0RHJpbmtzRm9yVmlldyA9IGdldERyaW5rc0ZvclZpZXc7XHJcblxyXG4gICAgICAgIGFjdGl2YXRlKCk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xyXG4gICAgICAgICAgICBNZWFsc0ZhY3RvcnkuZ2V0TWVhbHMoKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZ2V0RHJpbmtzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldERyaW5rcyhkcmlua3NPYmopIHtcclxuICAgICAgICAgICAgdm0uY3VycmVuY3kgPSBkcmlua3NPYmouY3VycmVuY3k7XHJcbiAgICAgICAgICAgIGRyaW5rcyAgICAgID0gZHJpbmtzT2JqLmRyaW5rcztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG9wZW5Ecmluayhkcmluaykge1xyXG4gICAgICAgICAgICBNZWFsc0ZhY3Rvcnkub3Blbk1lYWwoZHJpbmssIFwibmV3XCIsIDEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0RHJpbmtzRm9yVmlldygpIHtcclxuXHJcbiAgICAgICAgICAgIGlmICh2bS5vbmx5U29mdERyaW5rcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRyaW5rcy5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0udGlwcGxlICE9PSB0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkcmlua3M7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoXCJNZWFsc1wiKVxyXG4gICAgICAgIC5jb21wb25lbnQoXCJlcnJvclBhZ2VcIiwge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybCA6IFwiY29tcG9uZW50LXRlbXBsYXRlcy9lcnJvci90ZW1wbGF0ZS9lcnJvclBhZ2UuaHRtbFwiLFxyXG4gICAgICAgICAgICBiaW5kaW5ncyA6IHt9LFxyXG4gICAgICAgICAgICBjb250cm9sbGVyQXMgOiBcImVycm9yXCIsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXIgOiBFcnJvckNvbnRyb2xsZXJcclxuICAgICAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBFcnJvckNvbnRyb2xsZXIoKSB7fVxyXG59KSgpOyIsIihmdW5jdGlvbigpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKFwiTWVhbHNcIilcclxuICAgICAgICAuY29tcG9uZW50KFwiZm9vdGVyUGFnZVwiLCB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsIDogXCJjb21wb25lbnQtdGVtcGxhdGVzL2Zvb3Rlci90ZW1wbGF0ZS9mb290ZXJQYWdlLmh0bWxcIixcclxuICAgICAgICAgICAgYmluZGluZ3MgOiB7fSxcclxuICAgICAgICAgICAgY29udHJvbGxlckFzIDogXCJmb290ZXJcIixcclxuICAgICAgICAgICAgY29udHJvbGxlciA6IEZvb3RlckNvbnRyb2xsZXJcclxuICAgICAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBGb290ZXJDb250cm9sbGVyKCkge31cclxufSkoKTsiLCIoZnVuY3Rpb24oKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZShcIk1lYWxzXCIpXHJcbiAgICAgICAgLmNvbXBvbmVudChcImhlYWRlclBhZ2VcIiwge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybCA6IFwiY29tcG9uZW50LXRlbXBsYXRlcy9oZWFkZXIvdGVtcGxhdGUvaGVhZGVyUGFnZS5odG1sXCIsXHJcbiAgICAgICAgICAgIGJpbmRpbmdzIDoge30sXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBcyA6IFwiaGVhZGVyXCIsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXIgOiBIZWFkZXJDb250cm9sbGVyXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgZnVuY3Rpb24gSGVhZGVyQ29udHJvbGxlcigpIHt9XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoXCJNZWFsc1wiKVxyXG4gICAgICAgIC5jb21wb25lbnQoXCJsb2dvUGFnZVwiLCB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsIDogXCJjb21wb25lbnQtdGVtcGxhdGVzL2xvZ28vdGVtcGxhdGUvbG9nb1BhZ2UuaHRtbFwiLFxyXG4gICAgICAgICAgICBiaW5kaW5ncyA6IHt9LFxyXG4gICAgICAgICAgICBjb250cm9sbGVyQXMgOiBcImxvZ29cIixcclxuICAgICAgICAgICAgY29udHJvbGxlciA6IExvZ29Db250cm9sbGVyXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgZnVuY3Rpb24gTG9nb0NvbnRyb2xsZXIoKSB7fVxyXG59KSgpOyIsIihmdW5jdGlvbigpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKFwiTWVhbHNcIilcclxuICAgICAgICAuY29tcG9uZW50KFwibWFpblBhZ2VcIiwge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybCA6IFwiY29tcG9uZW50LXRlbXBsYXRlcy9tYWluL3RlbXBsYXRlL21haW5QYWdlLmh0bWxcIixcclxuICAgICAgICAgICAgYmluZGluZ3MgOiB7fSxcclxuICAgICAgICAgICAgY29udHJvbGxlckFzIDogXCJtYWluXCIsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXIgOiBNYWluQ29udHJvbGxlclxyXG4gICAgICAgIH0pO1xyXG4gICAgXHJcbiAgICBmdW5jdGlvbiBNYWluQ29udHJvbGxlcigpIHt9XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xyXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cclxuXHRhbmd1bGFyXHJcblx0XHQubW9kdWxlKFwiTWVhbHNcIilcclxuXHRcdC5jb21wb25lbnQoXCJtZWFsUGFnZVwiLCB7XHJcblx0XHRcdHRlbXBsYXRlVXJsIDogXCJjb21wb25lbnQtdGVtcGxhdGVzL21lYWwvdGVtcGxhdGUvbWVhbFBhZ2UuaHRtbFwiLFxyXG5cdFx0XHRiaW5kaW5ncyA6IHtcclxuXHRcdFx0XHRwYXRoOiBcIkBcIlxyXG5cdFx0XHR9LFxyXG5cdFx0XHRjb250cm9sbGVyQXMgOiBcIm1lYWxcIixcclxuXHRcdFx0Y29udHJvbGxlciA6IE1lYWxDb250cm9sbGVyXHJcblx0XHR9KTtcclxuXHJcblx0ZnVuY3Rpb24gTWVhbENvbnRyb2xsZXIoTWVhbHNGYWN0b3J5LCBDYXJ0RmFjdG9yeSkge1xyXG5cclxuXHRcdGNvbnN0IHZtID0gdGhpcztcclxuXHJcblx0XHR2bS5jdXJyZW50TWVhbCAgPSBNZWFsc0ZhY3RvcnkuZ2V0Q3VycmVudE1lYWwoKTtcclxuXHRcdHZtLmN1cnJlbmN5ICAgICA9IE1lYWxzRmFjdG9yeS5nZXRDdXJyZW5jeSgpO1xyXG5cdFx0dm0uc2VsZWN0QW1vdW50ID0gTWVhbHNGYWN0b3J5LmdldEN1cnJlbnRNZWFsQW1vdW50KCk7XHJcblx0XHR2bS5tZWFsU3RhdHVzICAgPSBNZWFsc0ZhY3RvcnkuZ2V0Q3VycmVudE1lYWxTdGF0dXMoKTtcclxuXHRcdHZtLmNhcnRDb3VudCAgICA9IENhcnRGYWN0b3J5LmdldENhcnRMaXN0Q291bnQoKTtcclxuXHRcdHZtLmFkZE1lYWwgICAgICA9IGFkZE1lYWw7XHJcblx0XHR2bS5yZW1vdmVNZWFsICAgPSByZW1vdmVNZWFsO1xyXG5cdFx0dm0uc2F2ZU1lYWwgICAgID0gc2F2ZU1lYWw7XHJcblxyXG5cdFx0ZnVuY3Rpb24gYWRkTWVhbCgpIHtcclxuXHRcdFx0Q2FydEZhY3RvcnkuYWRkTWVhbFRvQ2FydExpc3Qodm0uY3VycmVudE1lYWwsIHZtLnNlbGVjdEFtb3VudCk7XHJcblx0XHR9XHJcblxyXG5cdFx0ZnVuY3Rpb24gcmVtb3ZlTWVhbCgpIHtcclxuXHRcdFx0Q2FydEZhY3RvcnkucmVtb3ZlTWVhbCgpO1xyXG5cdFx0XHRDYXJ0RmFjdG9yeS5kZWxldGVNb2RpZmllcnMoKTtcclxuXHRcdH1cclxuXHJcblx0XHRmdW5jdGlvbiBzYXZlTWVhbCgpIHtcclxuXHRcdFx0Q2FydEZhY3RvcnkucmVtb3ZlTWVhbCgpO1xyXG5cdFx0XHR2bS5hZGRNZWFsKCk7XHJcblx0XHR9XHJcblx0fVxyXG59KSgpOyIsIihmdW5jdGlvbigpIHtcclxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHJcblx0YW5ndWxhclxyXG5cdFx0Lm1vZHVsZShcIk1lYWxzXCIpXHJcblx0XHQuY29tcG9uZW50KFwibWVhbHNMaXN0XCIsIHtcclxuXHRcdFx0dGVtcGxhdGVVcmwgOiBcImNvbXBvbmVudC10ZW1wbGF0ZXMvbWVhbHNMaXN0L3RlbXBsYXRlL21lYWxzTGlzdC5odG1sXCIsXHJcblx0XHRcdGJpbmRpbmdzIDoge30sXHJcblx0XHRcdGNvbnRyb2xsZXJBcyA6IFwibWVhbHNMaXN0XCIsXHJcblx0XHRcdGNvbnRyb2xsZXIgOiBNZWFsc0xpc3RDb250cm9sbGVyXHJcblx0XHR9KTtcclxuXHJcblx0ZnVuY3Rpb24gTWVhbHNMaXN0Q29udHJvbGxlcihNZWFsc0ZhY3RvcnkpIHtcclxuXHJcblx0XHRjb25zdCB2bSA9IHRoaXM7XHJcblxyXG5cdFx0dm0ub3Blbk1lYWwgPSBvcGVuTWVhbDtcclxuXHRcdHZtLmN1cnJlbmN5ID0gXCJcIjtcclxuXHRcdHZtLnByb2R1Y3RzID0gbnVsbDtcclxuXHJcblx0XHRhY3RpdmF0ZSgpO1xyXG5cclxuXHRcdGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xyXG5cdFx0XHRNZWFsc0ZhY3RvcnkuZ2V0TWVhbHMoKVxyXG5cdFx0XHRcdC50aGVuKGdldFByb2R1Y3RzKTtcclxuXHRcdH1cclxuXHJcblx0XHRmdW5jdGlvbiBnZXRQcm9kdWN0cyhtZWFsc09iaikge1xyXG5cdFx0XHR2bS5jdXJyZW5jeSA9IG1lYWxzT2JqLmN1cnJlbmN5O1xyXG5cdFx0XHR2bS5wcm9kdWN0cyA9IG1lYWxzT2JqLnByb2R1Y3RzO1xyXG5cdFx0fVxyXG5cclxuXHRcdGZ1bmN0aW9uIG9wZW5NZWFsKG1lYWwpIHtcclxuXHRcdFx0TWVhbHNGYWN0b3J5Lm9wZW5NZWFsKG1lYWwsIFwibmV3XCIsIDEpO1xyXG5cdFx0fVxyXG5cdH1cclxufSkoKTsiLCIoZnVuY3Rpb24oKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZShcIk1lYWxzXCIpXHJcbiAgICAgICAgLmNvbXBvbmVudChcIm1lbnVQYWdlXCIsIHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmwgOiBcImNvbXBvbmVudC10ZW1wbGF0ZXMvbWVudS90ZW1wbGF0ZS9tZW51UGFnZS5odG1sXCIsXHJcbiAgICAgICAgICAgIGJpbmRpbmdzIDoge30sXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBcyA6IFwibWVudVwiLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyIDogTWVudUNvbnRyb2xsZXJcclxuICAgICAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBNZW51Q29udHJvbGxlcigpIHt9XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoXCJNZWFsc1wiKVxyXG4gICAgICAgIC5jb21wb25lbnQoXCJtb2RpZmllcnNQYWdlXCIsIHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmwgOiBcImNvbXBvbmVudC10ZW1wbGF0ZXMvbW9kaWZpZXJzL3RlbXBsYXRlL21vZGlmaWVyc1BhZ2UuaHRtbFwiLFxyXG4gICAgICAgICAgICBiaW5kaW5ncyA6IHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbmN5OiBcIkBcIlxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjb250cm9sbGVyQXMgOiBcIm1vZFwiLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyIDogTW9kaWZpZXJzQ29udHJvbGxlclxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIGZ1bmN0aW9uIE1vZGlmaWVyc0NvbnRyb2xsZXIoTWVhbHNGYWN0b3J5LCBNb2RpZmllcnNGYWN0b3J5KSB7XHJcblxyXG4gICAgICAgIGNvbnN0IHZtICAgICAgICAgICAgICAgID0gdGhpcztcclxuICAgICAgICBsZXQgICBzZWxlY3RlZE1vZGlmaWVycyA9IFtdO1xyXG5cclxuICAgICAgICB2bS5tb2RpZmllcnMgICAgICA9IE1lYWxzRmFjdG9yeS5nZXRNb2RpZmllcnMoKTtcclxuICAgICAgICB2bS5zZWxlY3RNb2RpZmllciA9IHNlbGVjdE1vZGlmaWVyO1xyXG5cclxuICAgICAgICBjbGVhblBpY2tNb2RpZmllcnMoKTtcclxuXHJcbiAgICAgICAgaWYgKE1lYWxzRmFjdG9yeS5nZXRDdXJyZW50TWVhbFN0YXR1cygpID09PSBcImVkaXRcIikge1xyXG4gICAgICAgICAgICBsZXQgY2hlY2tlZE1vZGlmaWVycyA9IE1vZGlmaWVyc0ZhY3RvcnkuZ2V0Q2hlY2tlZE1vZGlmaWVycygpO1xyXG4gICAgICAgICAgICBNb2RpZmllcnNGYWN0b3J5LnBpY2tDaGVja2VkTW9kaWZpZXJzKHZtLm1vZGlmaWVycywgc2VsZWN0ZWRNb2RpZmllcnMsIGNoZWNrZWRNb2RpZmllcnMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2xlYW5QaWNrTW9kaWZpZXJzKCkge1xyXG4gICAgICAgICAgICBpZiAodm0ubW9kaWZpZXJzKSB7XHJcbiAgICAgICAgICAgICAgICB2bS5tb2RpZmllcnMuZm9yRWFjaCgoaXRlbSkgPT4gaXRlbS5jaGVjayA9IGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2VsZWN0TW9kaWZpZXIobW9kaWZpZXIpIHtcclxuICAgICAgICAgICAgTW9kaWZpZXJzRmFjdG9yeS5zZWxlY3RNb2RpZmllcihzZWxlY3RlZE1vZGlmaWVycywgbW9kaWZpZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoKTsiLCIoZnVuY3Rpb24oKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZShcIk1lYWxzXCIpXHJcbiAgICAgICAgLmNvbXBvbmVudChcInNlbGVjdENvdW50XCIsIHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmwgOiBcImNvbXBvbmVudC10ZW1wbGF0ZXMvc2VsZWN0Q291bnQvdGVtcGxhdGUvc2VsZWN0Q291bnRQYWdlLmh0bWxcIixcclxuICAgICAgICAgICAgYmluZGluZ3MgOiB7XHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IFwiPVwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBcyA6IFwic2VsZWN0XCIsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXIgOiBTZWxlY3RDb3VudENvbnRyb2xsZXJcclxuICAgICAgICB9KTtcclxuICAgIFxyXG4gICAgZnVuY3Rpb24gU2VsZWN0Q291bnRDb250cm9sbGVyKCkge1xyXG5cclxuICAgICAgICBjb25zdCB2bSA9IHRoaXM7XHJcblxyXG4gICAgICAgIHZtLnNlbGVjdE51bSA9IHNlbGVjdE51bTtcclxuICAgICAgICB2bS5hY3RpdmVOdW0gPSBhY3RpdmVOdW07XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNlbGVjdE51bShudW0pIHtcclxuICAgICAgICAgICAgdm0uc2VsZWN0ID0gbnVtO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYWN0aXZlTnVtKG51bSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdm0uc2VsZWN0ID09PSBudW07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KSgpOyJdfQ==
